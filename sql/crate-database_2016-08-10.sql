# ************************************************************
# Sequel Pro SQL dump
# Version 4541
#
# http://www.sequelpro.com/
# https://github.com/sequelpro/sequelpro
#
# Host: 127.0.0.1 (MySQL 5.7.11-log)
# Database: mf
# Generation Time: 2016-08-10 07:44:55 +0000
# ************************************************************


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

# Dump of table mf_post
# ------------------------------------------------------------

DROP TABLE IF EXISTS `mf_post`;

CREATE TABLE `mf_post` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `user_id` int(10) unsigned NOT NULL DEFAULT '1' COMMENT '用户',
  `title` varchar(255) NOT NULL COMMENT '标题',
  `title_second` varchar(255) NOT NULL DEFAULT '' COMMENT '副标题',
  `title_style` varchar(255) NOT NULL DEFAULT '' COMMENT '标题样式',
  `html_path` varchar(100) NOT NULL DEFAULT '' COMMENT 'html路径',
  `html_file` varchar(100) NOT NULL DEFAULT '' COMMENT 'html文件名',
  `catalog_id` smallint(5) unsigned NOT NULL DEFAULT '0' COMMENT '分类',
  `special_id` smallint(5) unsigned NOT NULL DEFAULT '0' COMMENT '专题编号',
  `introduce` text COMMENT '摘要',
  `image_list` text COMMENT '组图',
  `seo_title` varchar(255) NOT NULL DEFAULT '' COMMENT 'SEO标题',
  `seo_description` text COMMENT 'SEO描述',
  `seo_keywords` varchar(255) NOT NULL DEFAULT '' COMMENT 'SEO关键字',
  `content` mediumtext NOT NULL COMMENT '内容',
  `copy_from` varchar(100) NOT NULL DEFAULT '' COMMENT '来源',
  `copy_url` varchar(255) NOT NULL DEFAULT '' COMMENT '来源url',
  `redirect_url` varchar(255) NOT NULL DEFAULT '' COMMENT '跳转URL',
  `tags` varchar(255) NOT NULL DEFAULT '' COMMENT 'tags',
  `view_count` int(10) unsigned NOT NULL DEFAULT '1' COMMENT '查看次数',
  `commend` enum('Y','N') NOT NULL DEFAULT 'N' COMMENT '推荐',
  `attach_status` enum('Y','N') NOT NULL DEFAULT 'N' COMMENT '是否上传附件',
  `attach_file` varchar(255) NOT NULL DEFAULT '' COMMENT '附件名称',
  `attach_thumb` varchar(255) NOT NULL DEFAULT '' COMMENT '附件缩略图',
  `favorite_count` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '收藏数量',
  `attention_count` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '关注次数',
  `top_line` enum('Y','N') NOT NULL DEFAULT 'N' COMMENT '置顶',
  `update_time` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '最后更新时间',
  `reply_count` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '回复次数',
  `reply_allow` enum('Y','N') NOT NULL DEFAULT 'Y' COMMENT '允许评论',
  `sort_desc` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '排序',
  `status` enum('Y','N') NOT NULL DEFAULT 'Y' COMMENT '是否显示',
  `create_time` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '添加时间',
  PRIMARY KEY (`id`),
  KEY `tags_index` (`tags`) USING BTREE
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COMMENT='内容管理';

LOCK TABLES `mf_post` WRITE;
/*!40000 ALTER TABLE `mf_post` DISABLE KEYS */;

INSERT INTO `mf_post` (`id`, `user_id`, `title`, `title_second`, `title_style`, `html_path`, `html_file`, `catalog_id`, `special_id`, `introduce`, `image_list`, `seo_title`, `seo_description`, `seo_keywords`, `content`, `copy_from`, `copy_url`, `redirect_url`, `tags`, `view_count`, `commend`, `attach_status`, `attach_file`, `attach_thumb`, `favorite_count`, `attention_count`, `top_line`, `update_time`, `reply_count`, `reply_allow`, `sort_desc`, `status`, `create_time`)
VALUES
	(14,1,'天河二号以每秒3.3亿亿次的速度再居世界超算榜首 上演帽子戏法','','','','',2,1,'据外媒报道，23日在德国莱比锡市发布的第43届世界超级计算机500强排行榜上，中国超级计算机系统“天河二号”以每秒3.386亿亿次的浮点运算速度稳居榜首，获得世界超算“三连冠”。 ','','','','','<p style=\"text-indent:2em;\">\r\n	<img src=\"http://www.yii.local/uploads/images/201406/5e7d89999bb.jpg\" alt=\"\" height=\"418\" width=\"772\" /> \r\n</p>\r\n<p style=\"text-indent:2em;\">\r\n	<span style=\"font-size:14px;\">北京时间6月24日消息，据美国科技网站</span><a href=\"http://www.cnet.com/news/top500-supercomputer-race-hits-a-slow-patch/\" target=\"_blank\"><span style=\"font-size:14px;\">CNET</span></a><span style=\"font-size:14px;\">报道，23日在德国莱比锡市发布的</span><a href=\"http://top500.org/blog/lists/2014/06/press-release/\" target=\"_blank\"><span style=\"font-size:14px;\">第43届世界超级计算机500强排行榜</span></a><span style=\"font-size:14px;\">上，中国超级计算机系统“天河二号”以每秒3.386亿亿次的浮点运算速度稳居榜首，获得世界超算“三连冠”。美国能源部下属橡树岭国家实验室的“泰坦”则连续3次屈居亚军，其浮点运算速度为每秒1.759亿亿次。</span> \r\n</p>\r\n<p style=\"text-indent:2em;\">\r\n	<span style=\"font-size:14px;\">2010年，由国防科技大学研制的天河一号在超算排行榜上首次夺冠，2013年，天河二号又两度位列榜首，昨天，天河二号第3次被评为全球最快的计算机，获得世界超算三连冠。</span> \r\n</p>\r\n<p style=\"text-indent:2em;\">\r\n	<span style=\"font-size:14px;\">据悉，国际TOP500组织是发布全球已安装的超级计算机系统排名的权威机构，每年发布两次，其目的是促进国际超级计算机领域的交流和合作，促进超级计算机的推广应用。</span> \r\n</p>\r\n<p style=\"text-indent:2em;\">\r\n	<span style=\"font-size:14px;\">超级计算机是计算机中功能最强、运算速度最快、存储容量最大的一类计算机，多用于国家高科技领域和尖端技术研究。如：模拟核武器爆炸、模拟地球的气候、分析飞机的空气动力学和研究生物的大脑等。这些机器通常占用很大的橱柜和消耗大量的电力。</span> \r\n</p>\r\n<p style=\"text-align:center;\">\r\n	<img src=\"/uploads/attached/image/201406/f6cf41e3649.jpg\" alt=\"\" /> \r\n</p>\r\n<p style=\"text-indent:2em;\">\r\n	<span style=\"font-size:14px;\">世界上最快的计算机的性能在过去的二十年中一直在稳步的提升，最新数据显示，这个增长趋势在放缓。从2013年11月至今，排行榜前500的所有超级计算机的性能总和从25亿亿次提高到了27.4亿亿次。相关分析人士认为这是一个明显的增长放缓。</span> \r\n</p>\r\n<p style=\"text-indent:2em;\">\r\n	<span style=\"font-size:14px;\">另外，在过去的五年内，排行榜最后一位的超级计算机以每年55%的速度提升，而1994年至2008年间，性能曾以每年90%的速度增长。</span> \r\n</p>','csdn','http://www.csdn.net/article/2014-06-24/2820355','','超级计算机,中国',34,'N','Y','uploads/images/201406/5e7d89999bb.jpg','uploads/thumbs/201406/small_5e7d89999bb.jpg',0,0,'N',1404120867,0,'Y',0,'N',1379554460),
	(49,1,'mac 终端 使用ftp命令','','','','',3,0,'1. 连接ftp服务器   格式：ftp [hostname| ip-address]   a)ftp ftp.drivehq.com   b)服务器询问你用户名和口令，输入后即可。   2. 下载文件   下载文件通常用get和mget这两条命令。   a) get   格式：get [remote-file] [local-file]   将单个文件从远端主机中传送至本地主机中.   b) mget   格式：mget [remote-files]   将多个文件从远端主机中传送至本地主机中.   如要获取服务器上Cahce目录下的所有文件,则   ftp&amp;gt; cd /rC...','','','','','<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	1. 连接ftp服务器\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	格式：ftp [hostname| ip-address]\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	a)ftp ftp.drivehq.com\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	b)服务器询问你用户名和口令，输入后即可。\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	2. 下载文件\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	下载文件通常用get和mget这两条命令。\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	a) get\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	格式：get [remote-file] [local-file]\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	将单个文件从远端主机中传送至本地主机中.\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	b) mget\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	格式：mget [remote-files]\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	将多个文件从远端主机中传送至本地主机中.\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	如要获取服务器上Cahce目录下的所有文件,则\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	ftp&amp;gt; cd /rCache\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	ftp&amp;gt; mget *.*&nbsp;\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	3.上传文件\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	a) put\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	格式：put local-file [remote-file]\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	将本地主机中一个文件传送至远端主机.\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	b) mput\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	将本地主机中一批文件传送至远端主机.\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	如要把本地当前目录下所有odt文件上传到服务器Doc目录下\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	ftp&amp;gt; cd /Doc&nbsp;\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	ftp&amp;gt; mput *.odt\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	4. 断开连接\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	bye：中断与服务器的连接。\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	ftp&amp;gt; bye\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	另：默认的本地目录是home。\r\n</p>\r\n<p style=\"color:#232323;font-family:Corbel, Verdana, Arial, Helvetica, sans-serif;font-size:14px;\">\r\n	&nbsp; &nbsp; &nbsp; &nbsp; 输入help即可获得所有命令的帮助。\r\n</p>','','','','mac',4,'N','N','','',0,0,'N',1465644747,0,'Y',0,'Y',1465644747),
	(50,1,'phpstorm+Xdebug断点调试PHP','','','','',24,0,'运行环境：   PHPSTORM版本 : 8.0.1   PHP版本 : 5.6.2   xdebug版本：php_xdebug-2.2.5-5.6-vc11-x86_64.dll   ps : php版本和xdebug版本一定要相对应   1. PHP安装xdebug扩展   php.ini的配置，下面的配置仅供参考，路径要换成自己的！   [xdebug]   zend_extension=&quot;D:\\wamp\\php-5.6.2-x64\\ext\\php_xdebug-2.2.5-5.6-vc11-x86_64.dll&quot;   xdebug.remote_enable = On   xdebug.remote_handler = dbgp      xdebug.remote_host= ...','','','','','<p>\r\n	<span style=\"font-size:16px;\"><strong><span style=\"color:#FF0000;\">运行环境：</span></strong></span> \r\n</p>\r\n<p>\r\n	<span style=\"font-size:12.5px;\">PHPSTORM版本 : 8.0.1</span> \r\n</p>\r\n<p>\r\n	PHP版本 : 5.6.2\r\n</p>\r\n<p>\r\n	xdebug版本：php_xdebug-2.2.5-5.6-vc11-x86_64.dll\r\n</p>\r\n<p>\r\n	<span style=\"color:#FF0000;\">ps : php版本和xdebug版本一定要相对应</span> \r\n</p>\r\n<p>\r\n	<span style=\"font-size:16px;\"><strong><span style=\"color:#FF0000;background-color:#FFFFFF;\">1. PHP安装xdebug扩展</span></strong></span> \r\n</p>\r\n<p>\r\n	php.ini的配置，下面的配置仅供参考，路径要换成自己的！\r\n</p>\r\n<p>\r\n	[xdebug]\r\n</p>\r\n<p>\r\n	zend_extension=\"D:\\wamp\\php-5.6.2-x64\\ext\\php_xdebug-2.2.5-5.6-vc11-x86_64.dll\"\r\n</p>\r\n<p>\r\n	xdebug.remote_enable = On\r\n</p>\r\n<p>\r\n	xdebug.remote_handler = dbgp &nbsp;&nbsp;\r\n</p>\r\n<p>\r\n	xdebug.remote_host= localhost\r\n</p>\r\n<p>\r\n	xdebug.remote_port = 9000\r\n</p>\r\n<p>\r\n	xdebug.idekey = PHPSTORM\r\n</p>\r\n<p>\r\n	<span style=\"color:#FF0000;\">ps :&nbsp;<span style=\"line-height:22.5px;\">remote_handler 、<span style=\"line-height:22.5px;\">remote_host、<span style=\"line-height:22.5px;\">remote_port 这些都有默认值，但还是建议设置下，至少知道要设置这些参数~</span></span></span></span> \r\n</p>\r\n<p>\r\n	<span style=\"font-size:16px;\"><strong>查看phpinfo~</strong></span> \r\n</p>\r\n<p>\r\n	<a href=\"http://static.oschina.net/uploads/space/2014/1128/145010_c0MC_174025.png\" target=\"_blank\"><img src=\"http://static.oschina.net/uploads/space/2014/1128/145010_c0MC_174025.png\" /></a> \r\n</p>\r\n<p>\r\n	<strong><span style=\"font-size:16px;color:#FF0000;\">2.PHPSTORM设置</span></strong> \r\n</p>\r\n<p>\r\n	楼主以前一直用zendstudio，刚开始用phpstorm非常蛋疼，用了一段时间后发现还挺好用的~\r\n</p>\r\n<p>\r\n	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#FF0000;\">&nbsp;&nbsp;1.首先检查phpstorm的xdebug配置</span> \r\n</p>\r\n<p>\r\n	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;这里的debug port要和php.ini里面的<span style=\"line-height:22.5px;\">xdebug.remote_port相一致！默认是9000，如果9000端口被占用的话，可以改成其他端口。</span> \r\n</p>\r\n<p>\r\n	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</p>\r\n<p>\r\n	<a href=\"http://static.oschina.net/uploads/space/2014/1128/145902_y6XI_174025.png\" target=\"_blank\"><img src=\"http://static.oschina.net/uploads/space/2014/1128/145902_y6XI_174025.png\" /></a>&nbsp;\r\n</p>\r\n<p>\r\n	<a href=\"http://static.oschina.net/uploads/space/2014/1128/145902_KUqS_174025.png\" target=\"_blank\"><img src=\"http://static.oschina.net/uploads/space/2014/1128/145902_KUqS_174025.png\" /></a> \r\n</p>\r\n<p>\r\n	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; <span style=\"color:#FF0000;\">2. 设置debug.</span> \r\n</p>\r\n<p>\r\n	<span style=\"color:#FF0000;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> \r\n</p>\r\n<p>\r\n	<a href=\"http://static.oschina.net/uploads/space/2014/1128/150910_Cu3g_174025.png\" target=\"_blank\"><img src=\"http://static.oschina.net/uploads/space/2014/1128/150910_Cu3g_174025.png\" /></a> \r\n</p>\r\n<p>\r\n	<br />\r\n</p>\r\n<p>\r\n	<a href=\"http://static.oschina.net/uploads/space/2014/1128/150910_uD44_174025.png\" target=\"_blank\"><img src=\"http://static.oschina.net/uploads/space/2014/1128/150910_uD44_174025.png\" /></a> \r\n</p>\r\n<p>\r\n	<span style=\"color:#FF0000;\">添加本地的 web server~</span> \r\n</p>\r\n<p>\r\n	&nbsp;<a href=\"http://www.51open.pcom%E6%98%AF%E6%88%91%E6%9C%AC%E5%9C%B0%E7%9A%84web\">www.51open.pcom 是我本地的 web</a>&nbsp;server~ ~\r\n</p>\r\n<p>\r\n	<a href=\"http://static.oschina.net/uploads/space/2014/1128/150910_h0JI_174025.png\" target=\"_blank\"><img src=\"http://static.oschina.net/uploads/space/2014/1128/150910_h0JI_174025.png\" /></a> \r\n</p>\r\n<p>\r\n	<a href=\"http://static.oschina.net/uploads/space/2014/1128/150910_bTRe_174025.png\" target=\"_blank\"><img src=\"http://static.oschina.net/uploads/space/2014/1128/150910_bTRe_174025.png\" /></a> \r\n</p>\r\n<p>\r\n	<br />\r\n</p>\r\n<p>\r\n	<a href=\"http://static.oschina.net/uploads/space/2014/1128/150910_fFmC_174025.png\" target=\"_blank\"><img src=\"http://static.oschina.net/uploads/space/2014/1128/150910_fFmC_174025.png\" /></a> \r\n</p>\r\n<p>\r\n	<span style=\"color:#FF0000;\">3.开始调试</span> \r\n</p>\r\n<ol>\r\n	<li>\r\n		<p>\r\n			打好第一个断点，shift + F9就可以了\r\n		</p>\r\n	</li>\r\n	<li>\r\n		<p>\r\n			打好<span style=\"line-height:22.5px;\">第一个断点</span>，选中配置的debug, &nbsp;按旁边的臭虫 按钮\r\n		</p>\r\n	</li>\r\n</ol>\r\n<p>\r\n	<a href=\"http://static.oschina.net/uploads/space/2014/1128/151859_GZsW_174025.png\" target=\"_blank\"><img src=\"http://static.oschina.net/uploads/space/2014/1128/151859_GZsW_174025.png\" /></a> \r\n</p>','','','','php',4,'N','N','','',0,0,'N',1465645075,0,'Y',0,'Y',1465645019),
	(29,1,'Yii 框架创建自己的 web 应用','','','','',20,0,'Yii 是当今国内外最为流行的 PHP 框架。由于它高性能的特性，被公认为是“最有效率的 PHP 框架”。Yii 提供了今日 Web 2.0 应用开发所需要的几乎一切功能。它可以通过一个简单的命令 yiic 来快速创建一个 Web 应用程序的代码框架，开发人员通过在生成的代码框架上编写自己的业务逻辑，来实现 Web 应用的快速开发。本文将通过具体的实例对 Yii 框架进行阐述，使读者在真实的案例中去学习如何使用 Yii 框架创建自己的 Web 应用，从而对这个优秀的 PHP 框架有个更真实的体验。','','','','','<h2 style=\"text-indent:2em;\" id=\"major1\">\r\n	Yii 框架概述</h2><h3 style=\"text-indent:2em;\" id=\"minor1.1\">\r\n	Yii 是什么？</h3><p style=\"text-indent:2em;\">\r\n	Yii 是一个高性能的、基于组件的 PHP 框架，用于 Web 应用程序的快速开发。</p><p style=\"text-indent:2em;\">\r\n	Yii 的名字来源于“Yes It Is”的字母缩写。这句话肯定地回答了众多关于这个框架的疑问：“它是否快速？是否安全？是否强大？是否适合我们的项目？”</p><h3 style=\"text-indent:2em;\" id=\"minor1.2\">\r\n	Yii 适合做什么？</h3><p style=\"text-indent:2em;\">\r\n	Yii 是一个通用的轻量级 Web 编程框架，可以用于开发几乎所有的 Web 应用。具备它成熟的缓存机制，特别适用于开发高流量的应用，例如门户网站，论坛，内容管理系统（CMS），电子商务系统等等。</p><h3 style=\"text-indent:2em;\" id=\"minor1.3\">\r\n	Yii 和其他软件相比有哪些优势？</h3><p style=\"text-indent:2em;\">\r\n	和大多数 PHP 框架类似，Yii 是一个 MVC 框架，通过分离业务逻辑和用户界面，使开发者可以很容易地进行修改而不影响其它部分。</p><p style=\"text-indent:2em;\">\r\n	Yii 在设计时借鉴和集成了很多其他著名 Web 编程框架和应用，最大程度地考虑了 Web 应用开发的各种需要。所以 Yii 无论是在优异的性能上，还是丰富的功能和清晰的文档上，都使得它从众多 PHP 框架中脱颖而出。</p><p style=\"text-indent:2em;\" class=\"ibm-ind-link ibm-back-to-top\"><br/></p><h2 style=\"text-indent:2em;\" id=\"major2\">\r\n	Yii 的安装及配置</h2><h3 style=\"text-indent:2em;\" id=\"minor2.1\">\r\n	安装前的准备</h3><p style=\"text-indent:2em;\">\r\n	在\r\n安装和使用 Yii 之前，你需要有一个安装好 PHP 和 Web \r\n服务器的环境。目前，有很多集成环境软件可以轻松的实现这部分的安装。比如我们在这里使用的 WampServer。你可以从 WampServer \r\n的官方网站上下载和安装。WampServer 的安装非常简单，双击执行就可以了。安装过程中，它会自动为你安装 Apache， MySQL 和 \r\nPHP，不需要任何额外的配置，一切都完成得既轻松又简单。</p><h3 style=\"text-indent:2em;\" id=\"minor2.2\">\r\n	Yii 的安装</h3><p style=\"text-indent:2em;\">\r\n	Yii 的安装更是简单得让你难以想象，只需要执行下面两个步骤，就可以开始使用了。</p><p style=\"text-indent:2em;\">\r\n	一：从 Yii 的官方网站下载 Yii 框架</p><p style=\"text-indent:2em;\">\r\n	二：把下载的文件解压缩到一个 Web 可以访问的文件夹里</p><p style=\"text-indent:2em;\">\r\n	如果想验证 Yii 是否安装成功，只需要在浏览器中输入下面的 URL 就可以了。</p><pre class=\"displaycode\"><pre class=\"prettyprint lang-php\">http://hostname/path/to/yii/requirements/index.php</pre><br/></pre><p style=\"text-indent:2em;\">\r\n	下面是我们从浏览器里看到的页面显示。</p><h5 style=\"text-indent:2em;\" id=\"fig1\">\r\n	图 1. Yii 安装成功的页面显示</h5><p style=\"text-indent:2em;\"><img alt=\"图 1. Yii 安装成功的页面显示\" src=\"http://www.ibm.com/developerworks/cn/opensource/os-cn-yii/images/image001.jpg\" width=\"581\"/> </p><p style=\"text-indent:2em;\" class=\"ibm-ind-link ibm-back-to-top\"><br/></p><h2 style=\"text-indent:2em;\" id=\"major3\">\r\n	如何使用 Yii 创建 Web 应用</h2><h3 style=\"text-indent:2em;\" id=\"minor3.1\">\r\n	使用命令行工具 yiic 创建 web 应用</h3><p style=\"text-indent:2em;\">\r\n	Yiic 是一个命令行工具，通过它，你可以通过简单的使用一条命令，来创建一个完整的应用。</p><p style=\"text-indent:2em;\">\r\n	YiiRoot/framework/yiic webapp WebRoot/testdrive</p><p style=\"text-indent:2em;\">\r\n	比如：C:\\wamp\\www\\yii\\framework&gt;yiic.bat webapp c:\\wamp\\www\\abc</p><p style=\"text-indent:2em;\">\r\n	这条命令在 www 目录下面自动为你创建了一个名为 abc 的 Yii 的代码框架。你可以通过下面这个 URL 在本地访问这个刚刚创建的应用。</p><p style=\"text-indent:2em;\">\r\n	http://localhost/abc/index.php</p><p style=\"text-indent:2em;\">\r\n	下图就是我们刚刚创建的 Web 应用</p><h5 style=\"text-indent:2em;\" id=\"fig2\">\r\n	图 2. 使用 yiic 创建的 Web 应用</h5><p style=\"text-indent:2em;\"><img alt=\"图 2. 使用 yiic 创建的 Web 应用\" src=\"http://www.ibm.com/developerworks/cn/opensource/os-cn-yii/images/image002.jpg\" width=\"582\"/> </p><p style=\"text-indent:2em;\" class=\"ibm-ind-link ibm-back-to-top\"><br/></p><h2 style=\"text-indent:2em;\" id=\"major4\">\r\n	实例讲解基于 Yii 的测试数据维护系统的实现</h2><p style=\"text-indent:2em;\">\r\n	我们通过一个简单的测试数据维护系统来向大家演示如何使用 Yii framework 快速开发一个 Web 应用，来满足我们工作上的需要。</p><p style=\"text-indent:2em;\">\r\n	下面我来简要介绍一下这个 web 应用的基本需求：</p><p style=\"text-indent:2em;\">\r\n	这个 Web 应用主要实现对测试数据的维护和存储，包括增删改查等基本的功能。测试数据由两个二维表组成，两个表之间是“头 - 明细”的关系。所有数据存放在关系型数据库中，方便统计查询和日后的扩展。</p><h3 style=\"text-indent:2em;\" id=\"minor4.1\">\r\n	应用程序的设计和准备</h3><p style=\"text-indent:2em;\"><strong>功能需求</strong> </p><p style=\"text-indent:2em;\">\r\n	最基本的功能就是“增删改查”。这里就是分别对测试数据的主表和明细表两个表的进行增删改查的操作。</p><p style=\"text-indent:2em;\">\r\n	要求使用者用各自的用户登录使用，并记录最近修改人和日期。</p><p style=\"text-indent:2em;\"><strong>数据库的选择和设计</strong> </p><p style=\"text-indent:2em;\">\r\n	选用 SQLite 进行数据的存储。</p><p style=\"text-indent:2em;\">\r\n	SQLite 是一种小型的嵌入式数据库，它小巧灵活，资源占用少，处理速度快，非常适合中小型应用的数据存储。由于其各方面的出色表现，得到越来越多的开发人员的青睐。</p><p style=\"text-indent:2em;\"><strong>创建表：</strong> </p><p style=\"text-indent:2em;\">\r\n	根据应用程序的需要，我们将测试数据分别存放在两张表中。一个是主表，存放文件信息（file）；另一个是明细表，存在文件中的内容信息（pii）。两个表之间是“头 - 明细”的关系。</p><h5 style=\"text-indent:2em;\" id=\"listing1\"><span style=\"font-size:14px;\">清单 1. 创建表 pii 和 file 的 SQL 语句</span></h5><pre class=\"displaycode\">&nbsp;CREATE&nbsp;TABLE&nbsp;file&nbsp;(&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;INTEGER&nbsp;NOT&nbsp;NULL&nbsp;PRIMARY&nbsp;KEY&nbsp;AUTOINCREMENT,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;Package&nbsp;VARCHAR(50)&nbsp;NOT&nbsp;NULL,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;PiiFile&nbsp;VARCHAR(255)&nbsp;NOT&nbsp;NULL,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;FileInServer&nbsp;VARCHAR(255),&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;Comment&nbsp;VARCHAR(255)&nbsp;\r\n&nbsp;)&nbsp;\r\n&nbsp;CREATE&nbsp;TABLE&nbsp;&quot;pii&quot;&nbsp;(&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;INTEGER&nbsp;NOT&nbsp;NULL&nbsp;PRIMARY&nbsp;KEY&nbsp;AUTOINCREMENT,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;PiiFileId&nbsp;INTEGER&nbsp;NOT&nbsp;NULL,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;PiiStr&nbsp;VARCHAR(1000)&nbsp;NOT&nbsp;NULL,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;CaseNo&nbsp;VARCHAR(18)&nbsp;default&nbsp;&#39;-&#39;,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;Category&nbsp;VARCHAR(50),&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;Shipment&nbsp;INTEGER,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;UpdatedAt&nbsp;DATETIME,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;ModifiedBy&nbsp;VARCHAR(30),&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;Comment&nbsp;VARCHAR(255)&nbsp;\r\n&nbsp;)</pre><p style=\"text-indent:2em;\"><strong>数据初始化：</strong> </p><p style=\"text-indent:2em;\">\r\n	使用 SQLite Manager 导入数据。SQLite Manager 是一个 Firefox 的插件，可以方便的管理和维护 SQLite 数据库。</p><p style=\"text-indent:2em;\">\r\n	将\r\n准备好的测试数据整理成 csv, txt 等格式，通过 SQLite Manager \r\n进行导入。数据即可快速准备就绪。所有的数据都存放在嵌入式数据库 SQLite 中。在应用程序框架建立后，我们将准备好的数据库文件复制到目录 \r\nC:\\wamp\\www\\pii\\protected\\data 下。</p><h3 style=\"text-indent:2em;\" id=\"minor4.2\">\r\n	创建应用程序框架</h3><p style=\"text-indent:2em;\">\r\n	在上面我们提到“使用命令行工具 yiic 创建 web 应用”，这里，我们就演示一下如何通过命令行的方式来创建一个应用程序。</p><pre class=\"displaycode\">&nbsp;C:\\wamp\\www\\yii\\framework&gt;yiic.bat&nbsp;webapp&nbsp;c:\\wamp\\www\\pii</pre><p style=\"text-indent:2em;\">\r\n	这条命令在 www 目录下面自动为你创建了一个名为 pii 的 Yii 的代码框架。你可以通过下面这个 URL 在本地访问这个刚刚创建的应用。</p><p style=\"text-indent:2em;\">\r\n	http://localhost/pii/index.php</p><p style=\"text-indent:2em;\">\r\n	这时，我们看到 web 页面上有 4 个缺省的 tab：“Home”，“About”，“Contact”和“Login”。下面我们将在页面上加入一些基本功能的实现。</p><h3 style=\"text-indent:2em;\" id=\"minor4.3\">\r\n	加入基本功能</h3><p style=\"text-indent:2em;\"><strong>实现表的 CRUD 功能</strong> </p><p style=\"text-indent:2em;\">\r\n	首先，我们需要实现对文件信息的增删改查，即对表 file 中的数据进行操作和维护。</p><p style=\"text-indent:2em;\"><strong>1. 连接数据库：</strong> </p><p style=\"text-indent:2em;\">\r\n	将准备好的数据库文件 pii.sqlite 放置在 C:\\wamp\\www\\pii\\protected\\data 目录下。</p><p style=\"text-indent:2em;\">\r\n	在文件 C:\\wamp\\www\\pii\\protected\\config\\main.php 中，定义使用的数据库文件。</p><h5 style=\"text-indent:2em;\" id=\"listing2\"><span style=\"font-size:14px;\">清单 2. 定义数据库文件</span></h5><pre class=\"displaycode\"><pre class=\"prettyprint lang-php\">&#39;db&#39;=&gt;array(&nbsp;\r\n&nbsp;&#39;connectionString&#39;&nbsp;=&gt;&nbsp;&#39;sqlite:&#39;.dirname(__FILE__).&#39;/../data/pii.sqlite&#39;,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),</pre><br/></pre><p style=\"text-indent:2em;\"><strong>2. 配置 Gii 代码生成器</strong> </p><p style=\"text-indent:2em;\">\r\n	Gii 是一个强大 web 应用代码生成器，可以取代或者简化开发者的工作量，自动生成代码实现标准的功能模块。在使用前，我们需要对文件 C:\\wamp\\www\\pii\\protected\\config\\main.php 做些定义。</p><h5 style=\"text-indent:2em;\" id=\"listing3\"><span style=\"font-size:14px;\">清单 3. 配置 Gii 代码生成器</span></h5><pre class=\"displaycode\"><pre class=\"prettyprint lang-php\">&#39;import&#39;=&gt;array(&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&#39;application.models.*&#39;,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&#39;application.components.*&#39;,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),&nbsp;\r\n&nbsp;&nbsp;&#39;modules&#39;=&gt;array(&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&#39;gii&#39;=&gt;array(&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;class&#39;=&gt;&#39;system.gii.GiiModule&#39;,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;password&#39;=&gt;&#39;password&#39;,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),</pre><br/></pre><p style=\"text-indent:2em;\">\r\n	定义之后，我们可以通过 URL http://hostname/pii/index.php?r=gii 来访问 Gii。</p><h5 style=\"text-indent:2em;\" id=\"fig3\"><span style=\"font-size:14px;\">图 3. Gii 代码生成器</span></h5><p style=\"text-indent:2em;\"><img alt=\"图 3. Gii 代码生成器\" src=\"http://www.ibm.com/developerworks/cn/opensource/os-cn-yii/images/image003.jpg\" width=\"503\"/> </p><h3 style=\"text-indent:2em;\" id=\"listing4\">\r\n	3. 使用 Gii 为数据表建模</h3><p style=\"text-indent:2em;\">\r\n	在 Gii 中，我们将使用 Model Generator 为数据库中的表建模。我们选择 Model Generator 之后，可以看到下面的页面。</p><h5 style=\"text-indent:2em;\" id=\"fig4\">\r\n	图 4. 使用 Model Generator 生成模块代码</h5><p style=\"text-indent:2em;\"><img alt=\"图 4. 使用 Model Generator 生成模块代码\" src=\"http://www.ibm.com/developerworks/cn/opensource/os-cn-yii/images/image004.jpg\" width=\"517\"/> </p><p style=\"text-indent:2em;\">\r\n	预览并生成代码，这个生成器会在 protected/models 生成模块文件 File.php。</p><p style=\"text-indent:2em;\"><strong>4. 为表创建 CRUD 代码</strong> </p><p style=\"text-indent:2em;\">\r\n	有了模块文件，我们需要使用 Gii 中的 Crud Generator 为这个模块生成 CRUD 代码。</p><h5 style=\"text-indent:2em;\" id=\"fig5\">\r\n	图 5. 使用 CRUD 生成器生成代码</h5><p style=\"text-indent:2em;\"><img alt=\"图 5. 使用 CRUD 生成器生成代码\" src=\"http://www.ibm.com/developerworks/cn/opensource/os-cn-yii/images/image005.jpg\" width=\"582\"/> </p><p style=\"text-indent:2em;\">\r\n	这时，通过 http://localhost/pii/index.php?r=file，你就可以看到 File 的维护界面了。</p><h5 style=\"text-indent:2em;\" id=\"fig6\">\r\n	图 6. 生成的 Files 维护界面</h5><p style=\"text-indent:2em;\"><img alt=\"图 6. 生成的 Files 维护界面\" src=\"http://www.ibm.com/developerworks/cn/opensource/os-cn-yii/images/image006.jpg\" width=\"582\"/> </p><p style=\"text-indent:2em;\">\r\n	使用同样的方法，我们也可以为明细表 pii 创建了相应的 php 文件和维护页面。</p><p style=\"text-indent:2em;\"><strong>5. 将创建的功能加入到 Web 应用中</strong> </p><p style=\"text-indent:2em;\">\r\n	下面，我们要介绍如何把刚刚创建的功能加入到 Web 应用中。首先，我们需要对文件 C:\\wamp\\www\\pii_OK\\protected\\views\\layouts\\main.php 进行一点修改。</p><p style=\"text-indent:2em;\">\r\n	在\r\n这个文件里，我们可以根据自己的需要来定制将要显示的页面。比如，看下面的代码，我们做了两处改动：第一是取消了 Home 和 Contact 两个 \r\ntab 的显示，我们通过加“//”注释了这两行代码。第二是增加了两个 tab：Files 和 \r\nPIIs，新增加的两行代码实现了显示上面步骤里我们创建的两个页面。</p><h5 style=\"text-indent:2em;\" id=\"listing5\"><span style=\"font-size:14px;\">清单 4. 自定义标签页</span></h5><pre class=\"displaycode\">&nbsp;&lt;div&nbsp;id=&quot;mainmenu&quot;&gt;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&lt;?php&nbsp;$this-&gt;widget(&#39;zii.widgets.CMenu&#39;,array(&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&#39;items&#39;=&gt;array(&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;array(&#39;label&#39;=&gt;&#39;Home&#39;,&nbsp;&#39;url&#39;=&gt;array(&#39;/site/index&#39;)),&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(&#39;label&#39;=&gt;&#39;Files&#39;,&nbsp;&#39;url&#39;=&gt;array(&#39;/file/admin&#39;)),&nbsp;&nbsp;//&nbsp;new&nbsp;added\r\n	&nbsp;&nbsp;&nbsp;array(&#39;label&#39;=&gt;&#39;PIIs&#39;,&nbsp;&#39;url&#39;=&gt;array(&#39;/pii/admin&#39;)),&nbsp;&nbsp;&nbsp;//&nbsp;new&nbsp;added\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(&#39;label&#39;=&gt;&#39;About&#39;,&nbsp;&#39;url&#39;=&gt;array(&#39;/site/page&#39;,&nbsp;&#39;view&#39;=&gt;&#39;about&#39;)),&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;array(&#39;label&#39;=&gt;&#39;Contact&#39;,&nbsp;&#39;url&#39;=&gt;array(&#39;/site/contact&#39;)),&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(&#39;label&#39;=&gt;&#39;Login&#39;,&nbsp;&#39;url&#39;=&gt;array(&#39;/site/login&#39;),&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;visible&#39;=&gt;Yii::app()-&gt;user-&gt;isGuest),&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(&#39;label&#39;=&gt;&#39;Logout&nbsp;(&#39;.Yii::app()-&gt;user-&gt;name.&#39;)&#39;,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;url&#39;=&gt;array(&#39;/site/logout&#39;),&nbsp;&#39;visible&#39;=&gt;!Yii::app()-&gt;user-&gt;isGuest)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),&nbsp;\r\n&nbsp;&nbsp;&nbsp;));&nbsp;?&gt;&nbsp;\r\n&nbsp;&lt;/div&gt;&lt;!--&nbsp;mainmenu&nbsp;--&gt;</pre><p style=\"text-indent:2em;\">\r\n	现在来看看效果吧。果然，Home 和 Contact 页面不见了，取代它们的是 Files 和 PIIs 页面。</p><h5 style=\"text-indent:2em;\" id=\"fig7\"><span style=\"font-size:14px;\">图 7. 加入了 Files 和 PIIs 的 Web 应用</span></h5><p style=\"text-indent:2em;\"><img alt=\"图 7. 加入了 Files 和 PIIs 的 Web 应用\" src=\"http://www.ibm.com/developerworks/cn/opensource/os-cn-yii/images/image007.jpg\" width=\"581\"/> </p><p style=\"text-indent:2em;\">\r\n	通过这一步，我们将新创建的两个数据表 DRUD 的应用就添加到我们的网页中了。我们已经可以直接通过这两个页面来维护表里面的数据了。</p><h3 style=\"text-indent:2em;\" id=\"minor4.4\">\r\n	完善功能</h3><p style=\"text-indent:2em;\">\r\n	到\r\n目前为止，一个关于数据表维护的 Web \r\n应用的主要功能就基本实现了。当然，我们经常会根据自己使用上的需要对现有的功能做一些完善。比如，我们需要对最后一个修改数据的人和日期做一个记录，我\r\n们需要隐藏一些字段的显示，调整一些字段的显示顺序，我们可能还需要增加一些用户来使用这个系统。因为大部分的代码框架已经通过 Gii \r\n实现了，我们只需要在此基础上做一些简单的添加和修改，就可以实现我们所需要的功能。现在，我们用记录最后修改人和修改日期为例，看看我们如何通过修改一\r\n些代码来完善想要的功能的。</p><p style=\"text-indent:2em;\">\r\n	比如，我们需要记录对 Pii 数据表最后做修改的用户和日期信息。我们首先要找到维护 Pii 表的那个 PHP 文件。在这个例子中，是文件 C:\\wamp\\www\\pii\\protected\\models\\Pii.php。我们在文件的最后增加下面的代码：</p><h5 style=\"text-indent:2em;\" id=\"listing6\"><span style=\"font-size:14px;\">清单 5. 记录修改日期和用户名</span></h5><p></p><pre class=\"prettyprint lang-php\">&nbsp;public&nbsp;function&nbsp;beforeSave()&nbsp;\r\n&nbsp;&nbsp;&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;date_default_timezone_set(&quot;Asia/Shanghai&quot;);&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;UpdatedAt=date(&#39;Y-m-d&nbsp;H:i:s&#39;);&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;ModifiedBy=Yii::app()-&gt;user-&gt;name;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;parent::beforeSave();&nbsp;\r\n&nbsp;&nbsp;&nbsp;}</pre><p></p><p style=\"text-indent:2em;\">\r\n	这段代码在保存数据前为 UpdateAt 和 ModifiedBy \r\n字段设置了用户名和修改日期，然后调用了父类的 beforeSave 方法。保存之后，你会发现，在页面上修改 Pii 数据之后，Updated \r\nAt 和 Modified By 字段的值被自动填入了默认的内容。</p><h5 style=\"text-indent:2em;\" id=\"fig8\">\r\n	图 8. 自动填写 Updated At 和 Modified By 字段</h5><p style=\"text-indent:2em;\"><img alt=\"图 8. 自动填写 Updated At 和 Modified By 字段\" src=\"http://www.ibm.com/developerworks/cn/opensource/os-cn-yii/images/image008.jpg\" width=\"582\"/> </p><p style=\"text-indent:2em;\" class=\"ibm-ind-link ibm-back-to-top\"><br/></p><h2 style=\"text-indent:2em;\" id=\"major5\">\r\n	结束语</h2><p style=\"text-indent:2em;\">\r\n	通\r\n过这篇文章，我们了解了 Yii 这个当今最为流行的 PHP 框架，并通过搭建一个测试数据维护系统的具体实例，学习了如何使用 Yii \r\n框架来创建一个 Web 应用。在这个实例中，我们还通过使用 Gii 代码生成器为应用自动创建代码框架，更好地体会到 Yii 在创建 Web \r\n应用上的快捷优势。我们期待这篇文章能起到一个“抛砖引玉”的作用，希望更多的人了解和使用这个框架，并开发出更多更好的应用。</p><p style=\"text-indent:2em;\"><br/></p>','developworks','http://www.ibm.com/developerworks/cn/opensource/os-cn-yii/','','php,mysql,web,sql,apache,yii,cms,文章,IT,服务器',36,'N','N','','',0,0,'N',1408692660,0,'Y',0,'Y',1407136800),
	(31,1,'安装eaccelerator加速PHP','','','','',17,0,'一、安装eaccelerator-0.9.5\r\n\r\n 1、首先下载并安装ZendOptimizer-3.3.9\r\n       把ZendOptimizer.so COPY到一个目录，执行以下命令：\r\n      chcon -t texrel_shlib_t /usr/lib/ZendOptimizer.so \r\n      execstack -c /usr/lib/ZendOptimizer.so \r\n      service httpd restart\r\n      service mysqld restart\r\n     基本上可以OK。\r\n\r\n 2、再安装eaccelerator-0.9.6加速软件\r\n\r\n # wget ht...','','','','','<p style=\"text-indent:2em;\">\r\n	<span style=\"font-size:14px;\">一、安装eaccelerator-0.9.5</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 1、首先下载并安装ZendOptimizer-3.3.9</span><br />\r\n<span style=\"font-size:14px;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 把ZendOptimizer.so COPY到一个目录，执行以下命令：</span><br />\r\n<span style=\"font-size:14px;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chcon -t texrel_shlib_t /usr/lib/ZendOptimizer.so&nbsp;</span><br />\r\n<span style=\"font-size:14px;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;execstack -c /usr/lib/ZendOptimizer.so&nbsp;</span><br />\r\n<span style=\"font-size:14px;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;service httpd restart</span><br />\r\n<span style=\"font-size:14px;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;service mysqld restart</span><br />\r\n<span style=\"font-size:14px;\">&nbsp;&nbsp;&nbsp;&nbsp; 基本上可以OK。</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 2、再安装eaccelerator-0.9.6加速软件</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> # wget </span><a href=\"http://bart.eaccelerator.net/source/0.9.6/eaccelerator-0.9.6.tar.bz2\"><span style=\"font-size:14px;\">http://bart.eaccelerator.net/source/0.9.6/eaccelerator-0.9.6.tar.bz2</span></a>\r\n</p>\r\n<p style=\"text-indent:2em;\">\r\n	<span style=\"font-size:14px;\"># tar jxvf eaccelerator-0.9.6.tar.bz2</span><br />\r\n<span style=\"font-size:14px;\"> # cd eaccelerator-0.9.6</span><br />\r\n<span style=\"font-size:14px;\"> #&nbsp; phpize </span><br />\r\n<span style=\"font-size:14px;\"> # ./configure --enable-eaccelerator=shared --with-php-config=/usr/bin/php-config</span><br />\r\n<span style=\"font-size:14px;\"> # make</span><br />\r\n<span style=\"font-size:14px;\"> # make install</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 这时会将eaccelerator安装到php目录中，屏幕会显示eaccelerator.so所在路径，例如：</span><br />\r\n<span style=\"font-size:14px;\"> Installing shared extensions:&nbsp; /usr/lib/php/modules　　记住这个路径。</span>\r\n</p>\r\n<p style=\"text-indent:2em;\">\r\n	<span style=\"font-size:14px;\">安装完成后需要修改/etc/ld.so.conf</span>\r\n</p>\r\n<p style=\"text-indent:2em;\">\r\n	<span style=\"font-size:14px;\">#vim /etc/lod.so.conf</span>\r\n</p>\r\n<p style=\"text-indent:2em;\">\r\n	<span style=\"font-size:14px;\">再最后一行添加 include /usr/lib/php/modules/*.so 后保存退出</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> eaccelerator即可以安装为PHP扩展，也可以安装为zend扩展，以下安装为PHP扩展。</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 在最后一行加入以下内容</span>\r\n</p>\r\n<div>\r\n	<div id=\"highlighter_177088\" class=\"syntaxhighlighter php\">\r\n<pre class=\"prettyprint lang-bsh\">[eaccelerator]\r\nextension=\"eaccelerator.so\"\r\neaccelerator.shm_size=\"16\"\r\neaccelerator.cache_dir=\"tmp/eaccelerator\"\r\neaccelerator.enable=\"1\"\r\neaccelerator.Optimizer=\"1\"\r\neaccelerator.check_mttime=\"1\"\r\neaccelerator.debug=\"0\"\r\neaccelerator.filter=\"\"\r\neaccelerator.shm_max=\"0\"\r\neaccelerator.shm_ttl=\"0\"\r\neaccelerator.shm_prune_period=\"0\"\r\neaccelerator.shm_only=\"0\"\r\neaccelerator.compress=\"1\"\r\neaccelerator.compress_level=\"9\"</pre>\r\n<br />\r\n	</div>\r\n</div>\r\n<p style=\"text-indent:2em;\">\r\n	<br />\r\n<span style=\"font-size:14px;\"> 建立缓存目录：</span><br />\r\n<span style=\"font-size:14px;\">&nbsp;　# mkdir -p /tmp/eaccelerator</span><br />\r\n<span style=\"font-size:14px;\">&nbsp;　# chmod 777 /tmp/eaccelerator</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 重启Apache：</span><br />\r\n<span style=\"font-size:14px;\"> # service httpd restart</span><br />\r\n<br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 3、检查ZendOptimizer和eaccelerator是否安装成功</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 创建一个phpinfo.php文件，内容如下：</span><br />\r\n<span style=\"font-size:14px;\"> &lt;?php</span><br />\r\n<span style=\"font-size:14px;\"> &nbsp; &nbsp;phpinfo();</span><br />\r\n<span style=\"font-size:14px;\"> ?&gt;</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 将该文件放置到网站目录，在浏览器中访问，如果出现以下内容则安装成功：</span><br />\r\n<span style=\"font-size:14px;\"> This program makes use of the Zend Scripting Language Engine:</span><br />\r\n<span style=\"font-size:14px;\"> Zend Engine v2.2.0, Copyright (c) 1998-2007 Zend Technologies</span><br />\r\n<span style=\"font-size:14px;\"> &nbsp; &nbsp;with eAccelerator v0.9.5, Copyright (c) 2004-2006 eAccelerator, by eAccelerator</span><br />\r\n<span style=\"font-size:14px;\"> &nbsp; &nbsp;with Zend Extension Manager v1.0.11, Copyright (c) 2003-2006, by Zend Technologies</span><br />\r\n<span style=\"font-size:14px;\"> &nbsp; &nbsp;with Zend Optimizer v3.2.2, Copyright (c) 1998-2006, by Zend Technologies </span><br />\r\n<br />\r\n<br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 二、eaccelerator配置信息详解(根据官方英文说明翻译)</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> extension=\"/data/webserver/php/lib/php/extensions/no-debug-zts-20060613/eaccelerator.so\"</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 解释：PHP扩展eaccelerator.so的路径。</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> --------------------</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> eaccelerator.shm_size=\"32\"</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 解释：eaccelerator可使用的共享内存大小(单位为MB)。</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 在Linux下，单个进程的最大内存使用量受/proc/sys/kernel/shmmax中设置的数字限制(单位为字节)，例如CentOS 4.4的shmmax默认值为33554432字节(33554432bytes/1024/1024=32MB)。</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 临时更改该值：</span><br />\r\n<span style=\"font-size:14px;\"> # echo 字节数 &gt; /proc/sys/kernel/shmmax</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 按照以上方法更改，在每次重启系统时，该值会被自动还原。如果想永久更改，可以修改/etc/sysctl.conf文件，设置：</span><br />\r\n<span style=\"font-size:14px;\"> kernel.shmmax = 字节数</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> --------------------</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> eaccelerator.cache_dir=\"/data/cache/eaccelerator\"</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 解释：缓存路径，可以使用命令mkdir -p /data/cache/eaccelerator创建该目录，然后使用命令chmod 0777 /data/cache/eaccelerator设置该目录权限为0777</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> --------------------</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> eaccelerator.enable=\"1\"</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 解释：打开或者关闭eaccelerator。\"1\"指打开，\"0\"指关闭。默认值为\"1\"。</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> --------------------</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> eaccelerator.optimizer=\"1\"</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 解释：打开或者关闭代码优化，开启可以加快代码的执行速度。\"1\"指打开，\"0\"指关闭。默认值为\"1\"。</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> --------------------</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> eaccelerator.check_mtime=\"1\"</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 解释：当打开此项时，eaccelerator会在每次请求时检查php文件的修改时间，看其是否被修改过，这会耗费一点时间，如果php文件被修改\r\n过，eaccelerator会重新编译缓存该php文件。当关闭此项时，如果php文件被修改，则需要手工删除eaccelerator缓存，才能显示\r\n被修改的php文件。\"1\"指打开，\"0\"指关闭。默认值为\"1\"。</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> --------------------</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> eaccelerator.debug=\"0\"</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 解释：打开或者关闭调试记录。当打开时，eaccelerator会将对一个缓存文件的每次请求都写进log。打开此项只对调试eaccelerator是否有BUG时有益处。\"1\"指打开，\"0\"指关闭。默认值为\"0\"。</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> --------------------</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> eaccelerator.filter=\"\"</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 解释：决定哪些PHP文件应该被缓存。可以指定一个范围(比如\"*.php *.phtml\")，这样被指定的文件就会被缓存。如果该范围以!开头，被指定的文件就不会被缓存。默认值为\"\"，表示缓存所有的PHP文件。 </span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> --------------------</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> eaccelerator.shm_max=\"0\"</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 解释：一个用户使用例如eaccelerator_put之类的函数能够往共享内存中加载的最大数据。默认值为\"0\"，表示不限制。(单位为字节)</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> --------------------</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> eaccelerator.shm_ttl=\"0\"</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 解释：当没有足够的空闲共享内存去尝试缓冲一个新脚本时，将删除至少在shm_ttl秒之前没有被访问过的文件。默认值为\"0\"，表示不尝试从共享内存中删除任何旧的脚本。(单位为秒)</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> --------------------</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> eaccelerator.shm_prune_period=\"0\"</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 解释：当没有足够的空闲共享内存去尝试缓冲一个新脚本时，将删所有旧脚本，前提是这个尝试在超过shm_prune_period秒之前被执行过。默认值为\"0\"，表示不尝试从共享内存中删除任何旧的脚本。(单位为秒)</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> --------------------</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> eaccelerator.shm_only=\"0\"</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 解释：打开或者关闭在磁盘上缓存编译过的脚本。这个参数对会话数据和内容缓存没有效果。默认值为\"0\"，表示使用磁盘和共享内存来缓存。</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> --------------------</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> eaccelerator.compress=\"1\"</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 解释：打开或者关闭缓存内容压缩。\"1\"指打开，\"0\"指关闭。默认值为\"1\"。</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> --------------------</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> eaccelerator.compress_level=\"9\"</span><br />\r\n<br />\r\n<span style=\"font-size:14px;\"> 解释：内存压缩的级别。默认值为\"9\"，表示最大压缩。</span>\r\n</p>','','','','php,mysql,web,html,sql,apache',62,'N','N','','',0,0,'N',1407223078,0,'Y',0,'Y',1407223078),
	(32,1,'Nginx的gzip配置参数说明','','','','',3,0,'gzip\r\n决定是否开启gzip模块\r\nparam:on|off\r\nexample:gzip on;\r\n	\r\n	\r\n		gzip_buffers \r\n设置gzip申请内存的大小,其作用是按块大小的倍数申请内存空间\r\nparam1:int\r\nparam2:int(k) 后面单位是k\r\nexample: gzip_buffers 4 8k;\r\n	\r\n	\r\n		gzip_comp_level\r\n设置gzip压缩等级，等级越底压缩速度越快文件压缩比越小，反之速度越慢文件压缩比越大\r\nparam:1-9\r\nexample:gzip_com_level 1;\r\n	\r\n	\r\n		gzip_min_length\r\n当返回内容大于此值...','','','','','<div id=\"cnblogs_post_body\">\r\n	<p>\r\n		<strong><span style=\"font-size:14px;line-height:2;\">gzip</span></strong><br />\r\n<span style=\"font-size:14px;line-height:2;\">决定是否开启gzip模块</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">param:on|off</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">example:gzip on;</span>\r\n	</p>\r\n	<p>\r\n		<strong><span style=\"font-size:14px;line-height:2;\">gzip_buffers&nbsp;</span></strong><br />\r\n<span style=\"font-size:14px;line-height:2;\">设置gzip申请内存的大小,其作用是按块大小的倍数申请内存空间</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">param1:int</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">param2:int(k) 后面单位是k</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">example: gzip_buffers 4 8k;</span>\r\n	</p>\r\n	<p>\r\n		<strong><span style=\"font-size:14px;line-height:2;\">gzip_comp_level</span></strong><br />\r\n<span style=\"font-size:14px;line-height:2;\">设置gzip压缩等级，等级越底压缩速度越快文件压缩比越小，反之速度越慢文件压缩比越大</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">param:1-9</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">example:gzip_com_level 1;</span>\r\n	</p>\r\n	<p>\r\n		<strong><span style=\"font-size:14px;line-height:2;\">gzip_min_length</span></strong><br />\r\n<span style=\"font-size:14px;line-height:2;\">当返回内容大于此值时才会使用gzip进行压缩,以K为单位,当值为0时，所有页面都进行压缩</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">param:int</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">example:gzip_min_length 1000;</span>\r\n	</p>\r\n	<p>\r\n		<strong><span style=\"font-size:14px;line-height:2;\">gzip_http_version</span></strong><br />\r\n<span style=\"font-size:14px;line-height:2;\">用于识别http协议的版本，早期的浏览器不支持gzip压缩，用户会看到乱码，所以为了支持前期版本加了此选项,目前此项基本可以忽略</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">param: 1.0|1.1</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">example:gzip_http_version 1.0</span>\r\n	</p>\r\n	<p>\r\n		<strong><span style=\"font-size:14px;line-height:2;\">gzip_proxied</span></strong><br />\r\n<span style=\"font-size:14px;line-height:2;\">Nginx做为反向代理的时候启用，</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">param:off|expired|no-cache|no-sotre|private|no_last_modified|no_etag|auth|any]</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">expample:gzip_proxied no-cache;</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">off – 关闭所有的代理结果数据压缩</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">expired – 启用压缩，如果header中包含”Expires”头信息</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">no-cache – 启用压缩，如果header中包含”Cache-Control:no-cache”头信息</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">no-store – 启用压缩，如果header中包含”Cache-Control:no-store”头信息</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">private – 启用压缩，如果header中包含”Cache-Control:private”头信息</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">no_last_modified – 启用压缩，如果header中包含”Last_Modified”头信息</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">no_etag – 启用压缩，如果header中包含“ETag”头信息</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">auth – 启用压缩，如果header中包含“Authorization”头信息</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">any – 无条件压缩所有结果数据</span>\r\n	</p>\r\n	<p>\r\n		<strong><span style=\"font-size:14px;line-height:2;\">gzip_types</span></strong><br />\r\n<span style=\"font-size:14px;line-height:2;\">设置需要压缩的MIME类型,非设置值不进行压缩</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">param:text/html|application/x-javascript|text/css|application/xml</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">example:gzip_types text/html;</span>\r\n	</p>\r\n	<p>\r\n		<strong><span style=\"font-size:14px;line-height:2;\">Demo</span></strong><br />\r\n<span style=\"font-size:14px;line-height:2;\">gzip on;</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">gzip_min_length 1000;</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">gzip_buffers 4 8k;</span><br />\r\n<span style=\"font-size:14px;line-height:2;\">gzip_types text/html application/x-javascript text/css application/xml;</span>\r\n	</p>\r\n</div>\r\n<p style=\"text-indent:2em;\">\r\n	<br />\r\n</p>','','','','html,nginx',41,'N','N','','',0,0,'N',1407313916,0,'Y',0,'Y',1407313916),
	(34,1,'mysql的数据类型int、bigint、smallint 和 tinyint取值范围','','','','',18,0,'使用整数数据的精确数字数据类型。      bigint      从 -2^63 (-9223372036854775808) 到 2^63-1 (9223372036854775807) 的整型数据（所有数字）。存储大小为 8 个字节。      int      从 -2^31 (-2,147,483,648) 到 2^31 - 1 (2,147,483,647) 的整型数据（所有数字）。存储大小为 4 个字节。int 的 SQL-92 同义字为 integer。      smallint      从 -2^15 (-32,768) 到 2^15 - 1 (32,767) 的整型数据。存储大小为 2 个字...','','','','','<div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		使用整数数据的精确数字数据类型。\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		<br />\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		<strong>bigint</strong>\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		<br />\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		从 -2^63 (-9223372036854775808) 到 2^63-1 (9223372036854775807) 的整型数据（所有数字）。存储大小为<span>&nbsp;</span><span style=\"color:red;\">8</span><span>&nbsp;</span>个字节。\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		<br />\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		<strong>int</strong>\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		<br />\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		从 -2^31 (-2,147,483,648) 到 2^31 - 1 (2,147,483,647) 的整型数据（所有数字）。存储大小为<span>&nbsp;</span><span style=\"color:red;\">4</span><span>&nbsp;</span>个字节。int 的 SQL-92 同义字为 integer。\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		<br />\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		<strong>smallint</strong>\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		<br />\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		从 -2^15 (-32,768) 到 2^15 - 1 (32,767) 的整型数据。存储大小为<span>&nbsp;</span><span style=\"color:red;\">2</span><span>&nbsp;</span>个字节。\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		<br />\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		<strong>tinyint</strong>\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		<br />\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		从 0 到 255 的整型数据。存储大小为<span>&nbsp;</span><span style=\"color:red;\">1</span><span>&nbsp;</span>字节。\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		<br />\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		注释\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		<br />\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		在支持整数值的地方支持 bigint 数据类型。但是，bigint 用于某些特殊的情况，当整数值超过 int 数据类型支持的范围时，就可以采用 bigint。在 SQL Server 中，int 数据类型是主要的整数数据类型。\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		<br />\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		在数据类型优先次序表中，bigint 位于 smallmoney 和 int 之间。\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		<br />\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		只有当参数表达式是 bigint 数据类型时，函数才返回 bigint。SQL Server 不会自动将其它整数数据类型（tinyint、smallint 和 int）提升为 bigint。\r\n	</div>\r\n</div>','','','','mysql,web,sql',41,'N','N','','',0,0,'N',1407480402,0,'Y',0,'Y',1407480402),
	(35,1,'Mysql基本用法','','','','',18,0,'#登录数据库   mysql -hlocalhost -uroot -p;   #修改密码   mysqladmin -uroot -pold password new;           #显示数据库   show databases;   #显示数据表   show tables;   #选择数据库   use examples;   #创建数据库并设置编码utf-8 多语言   create database `examples` default character set utf8 collate utf8_general_ci;   #删除数据库   drop database examples;   #创建表   create table test(   ...','','','','','<div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#登录数据库\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		mysql -hlocalhost -uroot -p;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#修改密码\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		mysqladmin -uroot -pold<span>&nbsp;</span>password<span>&nbsp;</span>new;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#显示数据库\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		show databases;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#显示数据表\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		show tables;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#选择数据库\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		use examples;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#创建数据库并设置编码utf-8 多语言\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		create<span>&nbsp;</span>database<span>&nbsp;</span>`examples`<span>&nbsp;</span>default<span>&nbsp;</span>character<span>&nbsp;</span>set<span>&nbsp;</span>utf8<span>&nbsp;</span>collate<span>&nbsp;</span>utf8_general_ci;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#删除数据库\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		drop<span>&nbsp;</span>database<span>&nbsp;</span>examples;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#创建表\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		create<span>&nbsp;</span>table<span>&nbsp;</span>test(\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;&nbsp;&nbsp;&nbsp;id<span>&nbsp;</span>int(10) unsigned zerofill<span>&nbsp;</span>not<span>&nbsp;</span>null<span>&nbsp;</span>auto_increment,\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;&nbsp;&nbsp;&nbsp;email<span>&nbsp;</span>varchar(40)<span>&nbsp;</span>not<span>&nbsp;</span>null,\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;&nbsp;&nbsp;&nbsp;ip<span>&nbsp;</span>varchar(15)<span>&nbsp;</span>not<span>&nbsp;</span>null,\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;&nbsp;&nbsp;&nbsp;state<span>&nbsp;</span>int(10)<span>&nbsp;</span>not<span>&nbsp;</span>null<span>&nbsp;</span>default<span>&nbsp;</span>\'-1\',\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;&nbsp;&nbsp;&nbsp;primary<span>&nbsp;</span>key<span>&nbsp;</span>(id)\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		)engine=InnoDB;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#显示表结构\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		describe\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#删除表\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		drop<span>&nbsp;</span>table<span>&nbsp;</span>test；\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#重命名表\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		alter<span>&nbsp;</span>table<span>&nbsp;</span>test_old rename test_new;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#添加列\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		alter<span>&nbsp;</span>table<span>&nbsp;</span>test<span>&nbsp;</span>add<span>&nbsp;</span>cn<span>&nbsp;</span>int(4)<span>&nbsp;</span>not<span>&nbsp;</span>null;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#修改列\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		alter<span>&nbsp;</span>table<span>&nbsp;</span>test change id id1<span>&nbsp;</span>varchar(10)<span>&nbsp;</span>not<span>&nbsp;</span>null;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#删除列\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		alter<span>&nbsp;</span>table<span>&nbsp;</span>test<span>&nbsp;</span>drop<span>&nbsp;</span>cn;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#创建索引\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		alter<span>&nbsp;</span>table<span>&nbsp;</span>test<span>&nbsp;</span>add<span>&nbsp;</span>index<span>&nbsp;</span>(cn,id);\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#删除索引\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		alter<span>&nbsp;</span>table<span>&nbsp;</span>test<span>&nbsp;</span>drop<span>&nbsp;</span>index<span>&nbsp;</span>cn\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#插入数据\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		insert<span>&nbsp;</span>into<span>&nbsp;</span>test (id,email,ip,state)<span>&nbsp;</span>values(2,\'qq@qq.com\',\'127.0.0.1\',\'0\');\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#删除数据\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		delete<span>&nbsp;</span>from<span>&nbsp;</span>test<span>&nbsp;</span>where<span>&nbsp;</span>id = 1;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#修改数据\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		update<span>&nbsp;</span>test<span>&nbsp;</span>set<span>&nbsp;</span>id=\'1\',email=\'q@qq.com\'<span>&nbsp;</span>where<span>&nbsp;</span>id=1;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#查数据\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		select<span>&nbsp;</span>*<span>&nbsp;</span>from<span>&nbsp;</span>test;&nbsp; #取所有数据\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		select<span>&nbsp;</span>*<span>&nbsp;</span>from<span>&nbsp;</span>test limit 0,2;&nbsp; #取前两条数据\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		select<span>&nbsp;</span>*<span>&nbsp;</span>from<span>&nbsp;</span>test email<span>&nbsp;</span>like<span>&nbsp;</span>\'%qq%\'<span>&nbsp;</span>#查含有qq字符 _表示一个 %表示多个\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		select<span>&nbsp;</span>*<span>&nbsp;</span>from<span>&nbsp;</span>test<span>&nbsp;</span>order<span>&nbsp;</span>by<span>&nbsp;</span>id<span>&nbsp;</span>asc;#降序desc\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		select<span>&nbsp;</span>*<span>&nbsp;</span>from<span>&nbsp;</span>test id<span>&nbsp;</span>not<span>&nbsp;</span>in(\'2\',\'3\');#id不含2,3或者去掉not表示含有\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		select<span>&nbsp;</span>*<span>&nbsp;</span>from<span>&nbsp;</span>test timer<span>&nbsp;</span>between<span>&nbsp;</span>1<span>&nbsp;</span>and<span>&nbsp;</span>10;#数据在1,10之间\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#---------------------------表连接知识------------------------------\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#等值连接又叫内链接<span>&nbsp;</span>inner<span>&nbsp;</span>join<span>&nbsp;</span>只返回两个表中连接字段相等的行\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		select<span>&nbsp;</span>*<span>&nbsp;</span>from<span>&nbsp;</span>A<span>&nbsp;</span>inner<span>&nbsp;</span>join<span>&nbsp;</span>B<span>&nbsp;</span>on<span>&nbsp;</span>A.id = B.id; #写法1\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		select<span>&nbsp;</span>*<span>&nbsp;</span>from<span>&nbsp;</span>A,B<span>&nbsp;</span>where<span>&nbsp;</span>A.id = B.id; #写法2\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		select<span>&nbsp;</span>a.id,a.title<span>&nbsp;</span>from<span>&nbsp;</span>A a<span>&nbsp;</span>inner<span>&nbsp;</span>join<span>&nbsp;</span>B b<span>&nbsp;</span>on<span>&nbsp;</span>a.id=b.id<span>&nbsp;</span>and<span>&nbsp;</span>a.id=1;#写法3 表的临时名称\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		select<span>&nbsp;</span>a.id<span>&nbsp;</span>as<span>&nbsp;</span>ID,a.title<span>&nbsp;</span>as<span>&nbsp;</span>标题<span>&nbsp;</span>from<span>&nbsp;</span>A<span>&nbsp;</span>inner<span>&nbsp;</span>join<span>&nbsp;</span>B<span>&nbsp;</span>on<span>&nbsp;</span>A.id=B.id;#添加as字句\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#左连接又叫外连接<span>&nbsp;</span>left<span>&nbsp;</span>join<span>&nbsp;</span>返回左表中所有记录和右表中连接字段相等的记录\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		select<span>&nbsp;</span>*<span>&nbsp;</span>from<span>&nbsp;</span>A<span>&nbsp;</span>left<span>&nbsp;</span>join<span>&nbsp;</span>B<span>&nbsp;</span>on<span>&nbsp;</span>A.id = B.id;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		select<span>&nbsp;</span>*<span>&nbsp;</span>from<span>&nbsp;</span>A<span>&nbsp;</span>left<span>&nbsp;</span>join<span>&nbsp;</span>(B,C,D)<span>&nbsp;</span>on<span>&nbsp;</span>(B.i1=A.i1<span>&nbsp;</span>and<span>&nbsp;</span>C.i2=A.i2<span>&nbsp;</span>and<span>&nbsp;</span>D.i3 = A.i3);#复杂连接\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#右连接又叫外连接<span>&nbsp;</span>right<span>&nbsp;</span>join<span>&nbsp;</span>返回右表中所有记录和左表中连接字段相等的记录\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		select<span>&nbsp;</span>*<span>&nbsp;</span>from<span>&nbsp;</span>A<span>&nbsp;</span>right<span>&nbsp;</span>join<span>&nbsp;</span>B<span>&nbsp;</span>on<span>&nbsp;</span>A.id = B.id;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#完整外部链接<span>&nbsp;</span>full<span>&nbsp;</span>join<span>&nbsp;</span>返回左右表中所有数据\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		select<span>&nbsp;</span>*<span>&nbsp;</span>from<span>&nbsp;</span>A<span>&nbsp;</span>full<span>&nbsp;</span>join<span>&nbsp;</span>B<span>&nbsp;</span>on<span>&nbsp;</span>A.id = B.id;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#交叉连接 没有where字句 返回卡迪尔积\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		select<span>&nbsp;</span>*<span>&nbsp;</span>from<span>&nbsp;</span>A<span>&nbsp;</span>cross<span>&nbsp;</span>join<span>&nbsp;</span>B;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		-------------------------表连接结束------------------------------------------------------------\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		-----------------索引创建------------------------------------------------\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		show<span>&nbsp;</span>index<span>&nbsp;</span>from<span>&nbsp;</span>A #查看索引\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		alter<span>&nbsp;</span>table<span>&nbsp;</span>A<span>&nbsp;</span>add<span>&nbsp;</span>primary<span>&nbsp;</span>key(id) #主键索引\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		alter<span>&nbsp;</span>table<span>&nbsp;</span>A<span>&nbsp;</span>add<span>&nbsp;</span>unique(name) #唯一索引\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		alter<span>&nbsp;</span>table<span>&nbsp;</span>A<span>&nbsp;</span>add<span>&nbsp;</span>index<span>&nbsp;</span>name(name) #普通索引\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		alter<span>&nbsp;</span>table<span>&nbsp;</span>A<span>&nbsp;</span>add<span>&nbsp;</span>fulltext(name) #全文索引\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		alter<span>&nbsp;</span>table<span>&nbsp;</span>A<span>&nbsp;</span>add<span>&nbsp;</span>index<span>&nbsp;</span>name(id,name) #多列索引\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#常用函数\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		abs(-1)#绝对值\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		pi()#pi值\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		sqrt(2)#平方根\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		mod(-5,3)#取余-2\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		ceil(10.6)#进位+1 结果11 ceil(10.0)结果10\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		floor(10.6)#取整 10\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		round(2.5)#四舍五入到整数 结果3\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		round(2.5,2)#保留两位小数 结果2.50\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		truncate(2.5234,3)#取小数后3位不四舍五入 2.523\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		sign(-2);#符号函数 返回-1 0还是0 正数返回1\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		pow(2,3),exp(2);#2的3次幂 或e的2次幂\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		log(2),log10(2);#求对数\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		radians(180),degrees(0.618);#角度弧度转换\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		sin(0.5),asin(0.5)#正弦和反正弦 类似cos acos tan atan\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		length(\'hi\')#计算字符长度\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		concat(\'1\',1,\'hi\')#合并字符串\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		insert(\'12345\',1,0,\'7890\');#从开头第1个字符开始到0个结束，替换成后边字符串，0表示在最前边插入\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		ucase(\'a\'),lcase(\'A\')#转成大写和小写\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		left(\'abcd\',2),right(\'abcd\',2);#返回前两个字符和后两个字符\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		ltrim(\'&nbsp; 0&nbsp; \'),rtrim(\' 0 \'),trim(\'&nbsp; 0&nbsp; \')#删除空格\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		replace(\'1234567890\',\'345678\',\'0\');#替换输出12090\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		substring(\'12345\',1,2)#取字符 输出12 1是位置 2是长度\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		instr(\'1234\',\'234\');#取得234位置是2\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		reverse(\'1234\');#反序输出4321\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		current()#返回日期\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		curtime()#返回时间\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		now()#返回日期时间\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		month(now())#当前月份 monthname 英文月份\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		dayname(now())#星期英文 dayofweek()1是星期天 weekday()1是星期二\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		week(now())#本年第多少周\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		dayofyear(now()),dayofmonth(now())#今天是本年第多少天 今天是本月第多少天\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		year(now()),month(now()),day(now()),hour(now()),minute(now()),second(now())#返回年月日 时分秒\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		time_to_sec(now()),sec_to_time(3600*8);#转换时间为秒和还原\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		version()#mysql版本\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		database()#当前连接的数据库 没有为null\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		user()#获取用户名\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		md5(\'a\')#加密字符串\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		ascii(\'a\')#ascii值97\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		bin(100),hex(100),oct(100)#返回二进制 十六进制 八进制\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		conv(10001,2,8);#各种进制相互转换\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		rand()#生成0到1之间随机数\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		sleep(0.02)#暂停秒数\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		数据库优化\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		.开启缓存，尽量使用php函数而不是mysql\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		. explain<span>&nbsp;</span>select<span>&nbsp;</span>语句可以知道性能\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		.一行数据使用 limit 1；\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		.为搜索字段重建索引 比如关键字 标签\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		.表连接join保证字段类型相同并且有其索引\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		.随机查询使用php $r = mysql_query(\"SELECT count(*) FROM user\");\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$d = mysql_fetch_row($r);\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rand = mt_rand(0,$d[0] - 1);\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$r = mysql_query(\"SELECT username FROM user LIMIT $rand, 1\");\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		.避免使用select<span>&nbsp;</span>* 应该使用具体字段\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		.每张表都是用id主键，并且是unsigned<span>&nbsp;</span>int\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		.对于取值有限而固定使用enum类型，如性别 国家 名族 部门 状态\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		.尽可能使用not<span>&nbsp;</span>null<span>&nbsp;</span>ip存储使用int(4),使用ip 转化函数ip2long()相互long2ip()\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		.delete和insert语句会锁表，所以可以采用分拆语句操作\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;&nbsp;&nbsp;&nbsp;while(1){操作语句;usleep(2000);}\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		.选择正确的存储引擎；MyISAM适合大量查询 写操作多用InnoDB支持事务\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#存储过程\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#存储程序\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		delimiter #定义存储程序\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		create<span>&nbsp;</span>procedure<span>&nbsp;</span>getversion(out<span>&nbsp;</span>params<span>&nbsp;</span>varchar(20)) #params是传出参数<span>&nbsp;</span>in传进<span>&nbsp;</span>out传出 inout传回\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		begin\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		select<span>&nbsp;</span>version()<span>&nbsp;</span>into<span>&nbsp;</span>params; #版本信息赋值params\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		end\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		call getversion(@a); #调用存储过程\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		select<span>&nbsp;</span>@a;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		delimiter #定义存储函数\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		create<span>&nbsp;</span>function<span>&nbsp;</span>display(w<span>&nbsp;</span>varchar(20))<span>&nbsp;</span>returns<span>&nbsp;</span>varchar(20)\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		begin\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		return<span>&nbsp;</span>concat(\'hello\',w);\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		end\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		select<span>&nbsp;</span>display(\'world\');\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		drop<span>&nbsp;</span>procedure<span>&nbsp;</span>if exists spName; #删除一个存储过程\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		alter<span>&nbsp;</span>function<span>&nbsp;</span>spName [];#修改一个存储过程\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		show<span>&nbsp;</span>create<span>&nbsp;</span>procedure<span>&nbsp;</span>spName;#显示存储过程信息\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		declare<span>&nbsp;</span>varName type<span>&nbsp;</span>default<span>&nbsp;</span>value;#声明局部变量\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#if语句\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		if 条件<span>&nbsp;</span>then<span>&nbsp;</span>语句\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		elseif 条件<span>&nbsp;</span>then<span>&nbsp;</span>语句\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		else<span>&nbsp;</span>语句\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		end<span>&nbsp;</span>if\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#case语句\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		case<span>&nbsp;</span>条件\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		when<span>&nbsp;</span>条件<span>&nbsp;</span>then<span>&nbsp;</span>语句\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		when<span>&nbsp;</span>条件<span>&nbsp;</span>then<span>&nbsp;</span>语句\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		else<span>&nbsp;</span>语句\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		end<span>&nbsp;</span>case\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#loop语句\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		fn:loop\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		语句\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		end<span>&nbsp;</span>loop fn;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		leave fn #退出循环\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#while语句\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		fn：while 条件 do\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		语句\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		end<span>&nbsp;</span>while fn\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#mysql使用帮助资料\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		? contents; #列出帮助类型\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		? data types;#列出数据类型\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		？<span>&nbsp;</span>int;#列出具体类型\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		? show;#show语句\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		?<span>&nbsp;</span>create<span>&nbsp;</span>table;#\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#常见表的比较\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;Myisam&nbsp;&nbsp; BDB&nbsp;&nbsp;&nbsp; Memory&nbsp;&nbsp;&nbsp; InnoDB&nbsp;&nbsp;&nbsp; Archive\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		存储限制&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;</span>no&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;</span>no&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;</span>yes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 64T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;</span>no\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		事物安全&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 支持&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 支持&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		锁机制&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 表锁&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 页锁&nbsp;&nbsp;&nbsp; 表锁&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 行锁&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 行锁\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		全文索引&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 支持\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		外键支持&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 支持\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		myisam&nbsp; frm存储表定义 MYD存储数据 MYI存储索引\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		InnoDB 用于事务处理\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		char<span>&nbsp;</span>和<span>&nbsp;</span>varchar保存和索引都不相同\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		浮点数float(10,2) 定点数decimal(10,2)\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		长度一定下，浮点数表示更大数据范围，缺点是引起精度丢失，货币等使用定点数存储\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		索引适合于where字句或者连接字句列\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		对于唯一值使用唯一索引\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		&nbsp;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		添加新用户<span>&nbsp;</span>grant<span>&nbsp;</span>select,insert,update,delete<span>&nbsp;</span>on<span>&nbsp;</span>*.*<span>&nbsp;</span>to<span>&nbsp;</span>Yoby@localhost identified<span>&nbsp;</span>by<span>&nbsp;</span>\'mysql\';\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *.* 数据库名.表名，限制登录某一个数据库 test.*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; localhost是本地主机 网络可以使用<span>&nbsp;</span>\'%\'代替所有主机&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;</span>\'mysql\'是密码 Yoby是用户名&nbsp; 所有权限可以用<span>&nbsp;</span>all代替\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		查看用户权限 show grants<span>&nbsp;</span>for<span>&nbsp;</span>\'root\'@\'localhost\';\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		移除权限&nbsp;<span>&nbsp;</span>revoke<span>&nbsp;</span>all<span>&nbsp;</span>on<span>&nbsp;</span>*.*<span>&nbsp;</span>from<span>&nbsp;</span>root@localhost;\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		group<span>&nbsp;</span>by<span>&nbsp;</span>id 分组\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		having<span>&nbsp;</span>限制字句\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		select1<span>&nbsp;</span>union<span>&nbsp;</span>select2 联合查询有重复去掉保留一行\r\n	</div>\r\n	<div style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;font-size:medium;\">\r\n		select2<span>&nbsp;</span>union<span>&nbsp;</span>all<span>&nbsp;</span>select2 所有行合并到结果集中去\r\n	</div>\r\n</div>','','','','php,mysql,web,sql',44,'N','N','','',0,0,'N',1407480442,0,'Y',0,'Y',1407480442),
	(36,1,'MySQL主从复制与读写分离','','','','',18,0,'MySQL主从复制(Master-Slave)与读写分离(MySQL-Proxy)实践   Mysql作为目前世界上使用最广泛的免费数据库，相信所有从事系统运维的工程师都一定接触过。但在实际的生产环境中，由单台Mysql作为独立的数据库是完全不能满足实际需求的，无论是在安全性，高可用性以及高并发等各个方面。   因此，一般来说都是通过 主从复制（Master-Slave）的方式来同步数据，再通过读写分离（MySQL-Proxy）来提升数据库的并发负载能力 这样的方案来...','','','','','<p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		MySQL主从复制(Master-Slave)与读写分离(MySQL-Proxy)实践	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		Mysql作为目前世界上使用最广泛的免费数据库，相信所有从事系统运维的工程师都一定接触过。但在实际的生产环境中，由单台Mysql作为独立的数据库是完全不能满足实际需求的，无论是在安全性，高可用性以及高并发等各个方面。	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		因此，一般来说都是通过 主从复制（Master-Slave）的方式来同步数据，再通过读写分离（MySQL-Proxy）来提升数据库的并发负载能力 这样的方案来进行部署与实施的。	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		如下图所示：<br/><img src=\"/uploads/attached/image/201408/74d131944d5.jpg\" alt=\"\"/></p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		下面是我在实际工作过程中所整理的笔记，在此分享出来，以供大家参考。	</p><p><strong>一、MySQL的安装与配置</strong><br/>具体的安装过程，建议参考我的这一篇文章：<a href=\"http://heylinux.com/archives/993.html\" target=\"_blank\"><span style=\"color:#2D83D5;\">http://heylinux.com/archives/993.html</span></a><br/>值得一提的是，我的安装过程都是源码包编译安装的，并且所有的配置与数据等都统一规划到了/opt/mysql目录中，因此在一台服务器上安装完成以后，可以将整个mysql目录打包，然后传到其它服务器上解包，便可立即使用。	</p><p>\r\n		&nbsp;&nbsp;主库my.ini</p><p>\r\n		&nbsp; <img src=\"/uploads/attached/image/201408/3f872683b37.png\" alt=\"\"/><br/></p><p><br/></p><p><strong>二、MySQL主从复制</strong><br/>&nbsp;&nbsp;&nbsp;&nbsp; 场景描述：<br/>&nbsp;&nbsp;&nbsp;&nbsp; 主数据库服务器：192.168.10.130，MySQL已经安装，并且无应用数据。<br/></p><p>\r\n			从数据库服务器：192.168.10.131，MySQL已经安装，并且无应用数据。		</p><p><br/></p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><strong>2.1 主服务器上进行的操作</strong><br/>&nbsp;&nbsp;&nbsp;&nbsp; 启动mysql服务<br/>&nbsp;&nbsp;&nbsp;&nbsp;/opt/mysql/init.d/mysql start	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		&nbsp;&nbsp;&nbsp;&nbsp;通过命令行登录管理MySQL服务器<br/>&nbsp;&nbsp;&nbsp;&nbsp;/opt/mysql/bin/mysql -uroot -p&#39;new-password&#39;	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		&nbsp;&nbsp;&nbsp;&nbsp;授权给从数据库服务器192.168.10.131	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		&nbsp;&nbsp;	</p><pre class=\"prettyprint lang-bsh\">mysql&gt;&nbsp;GRANT&nbsp;REPLICATION&nbsp;SLAVE&nbsp;ON&nbsp;*.*&nbsp;to&nbsp;&#39;rep1&#39;@&#39;192.168.10.131&#39;&nbsp;identified&nbsp;by&nbsp;‘password’;</pre><p><br/></p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		查询主数据库状态	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><br/>Mysql&gt; show master status;<br/>+------------------+----------+--------------+------------------+<br/>| File | Position | Binlog_Do_DB | Binlog_Ignore_DB |<br/>+------------------+----------+--------------+------------------+<br/>| mysql-bin.000005 | 261 | | |<br/>+------------------+----------+--------------+------------------+	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		记录下 FILE 及 Position 的值，在后面进行从服务器操作的时候需要用到。	</p><p><strong>2.2 配置从服务器</strong><br/>修改从服务器的配置文件/opt/mysql/etc/my.cnf<br/>将 server-id = 1修改为 server-id = 10，并确保这个ID没有被别的MySQL服务所使用。	</p><p><br/></p><p>\r\n		启动mysql服务	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		/opt/mysql/init.d/mysql start	</p><p>\r\n		通过命令行登录管理MySQL服务器<br/>/opt/mysql/bin/mysql -uroot -p&#39;new-password&#39;	</p><p><br/></p><p><br/>设置连接MASTER MASTER_LOG_FILE为主库的File，MASTER_LOG_POS为主库的Position&nbsp;	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		执行同步SQL语句	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><br/></p><pre class=\"prettyprint lang-bsh\">mysql&gt;&nbsp;change&nbsp;master&nbsp;to\r\nmaster_host=’192.168.10.130’,\r\nmaster_user=’rep1’,\r\nmaster_password=’password’,\r\nmaster_log_file=’mysql-bin.000005’,\r\nmaster_log_pos=261;</pre><p><br/></p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		正确执行后启动Slave同步进程<br/>mysql&gt; start slave;	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		主从同步检查<br/>mysql&gt; show slave status\\G<br/>==============================================<br/>**************** 1. row *******************<br/>Slave_IO_State:<br/>Master_Host: 192.168.10.130<br/>Master_User: rep1<br/>Master_Port: 3306<br/>Connect_Retry: 60<br/>Master_Log_File: mysql-bin.000005<br/>Read_Master_Log_Pos: 415<br/>Relay_Log_File: localhost-relay-bin.000008<br/>Relay_Log_Pos: 561<br/>Relay_Master_Log_File: mysql-bin.000005<br/>Slave_IO_Running: YES<br/>Slave_SQL_Running: YES<br/>Replicate_Do_DB:<br/>……………省略若干……………<br/>Master_Server_Id: 1<br/>1 row in set (0.01 sec)<br/>==============================================	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		其中Slave_IO_Running 与 Slave_SQL_Running 的值都必须为YES，才表明状态正常。	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><br/></p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><strong>如果主服务器已经存在应用数据，则在进行主从复制时，需要做以下处理：</strong></p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><br/>(1)主数据库进行锁表操作，不让数据再进行写入动作<br/>mysql&gt; FLUSH TABLES WITH READ LOCK;	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><br/></p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		(2)查看主数据库状态<br/>mysql&gt; show master status;	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><br/></p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		(3)记录下 FILE 及 Position 的值。<br/>将主服务器的数据文件（整个/opt/mysql/data目录）复制到从服务器，建议通过tar归档压缩后再传到从服务器解压。	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><br/></p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		(4)取消主数据库锁定<br/>mysql&gt; UNLOCK TABLES;	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><br/></p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><strong>2.3 验证主从复制效果</strong></p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><strong>主服务器上的操作</strong><br/>在主服务器上创建数据库first_db<br/>mysql&gt; create database first_db;<br/>Query Ok, 1 row affected (0.01 sec)	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		在主服务器上创建表first_tb<br/>mysql&gt; create table first_tb(id int(3),name char(10));<br/>Query Ok, 1 row affected (0.00 sec)	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		在主服务器上的表first_tb中插入记录<br/>mysql&gt; REPLACE INTO first_tb values (001,’myself’);<br/>Query Ok, 1 row affected (0.00 sec)	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><strong>在从服务器上查看</strong></p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><br/>mysql&gt; show databases;<br/>=============================<br/>+--------------------+<br/>| Database |<br/>+--------------------+<br/>| information_schema |<br/>| first_db |<br/>| mysql |<br/>| performance_schema |<br/>| test |<br/>+--------------------+<br/>5 rows in set (0.01 sec)<br/>=============================<br/>数据库first_db已经自动生成	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		mysql&gt; use first_db<br/>Database chaged	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		mysql&gt; show tables;<br/>=============================<br/>+--------------------+<br/>| Tables_in_first_db |<br/>+--------------------+<br/>| first_tb |<br/>+--------------------+<br/>1 row in set (0.02 sec)<br/>=============================<br/>数据库表first_tb也已经自动创建	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><br/></p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		mysql&gt; select * from first_tb;<br/>=============================<br/>+------+------+<br/>| id | name |<br/>+------+------+<br/>| 1 | myself |<br/>+------+------+<br/>1 rows in set (0.00 sec)<br/>=============================<br/>记录也已经存在	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		由此，整个MySQL主从复制的过程就完成了，接下来，我们进行MySQL读写分离的安装与配置。	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><strong>三、MySQL读写分离</strong></p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><br/>场景描述：<br/>数据库Master主服务器：192.168.10.130<br/>数据库Slave从服务器：192.168.10.131<br/>MySQL-Proxy调度服务器：192.168.10.132	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		以下操作，均是在192.168.10.132即MySQL-Proxy调度服务器 上进行的。	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><strong>3.1 MySQL的安装与配置</strong><br/>具体的安装过程与上文相同。	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><strong>3.2 检查系统所需软件包</strong><br/>通过 rpm -qa | grep name 的方式验证以下软件包是否已全部安装。<br/>gcc* gcc-c++* autoconf* automake* zlib* libxml* ncurses-devel* libmcrypt* libtool* flex* pkgconfig*<br/>libevent* glib*	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		若缺少相关的软件包，可通过yum -y install方式在线安装，或直接从系统安装光盘中找到并通过rpm -ivh方式安装。	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><strong>3.3 编译安装lua</strong><br/>MySQL-Proxy的读写分离主要是通过rw-splitting.lua脚本实现的，因此需要安装lua。	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		lua可通过以下方式获得<br/>从http://www.lua.org/download.html下载源码包	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		从rpm.pbone.net搜索相关的rpm包<br/>download.fedora.redhat.com/pub/fedora/epel/5/i386/lua-5.1.4-4.el5.i386.rpm<br/>download.fedora.redhat.com/pub/fedora/epel/5/x86_64/lua-5.1.4-4.el5.x86_64.rpm	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		这里我们建议采用源码包进行安装<br/>cd /opt/install<br/>wget http://www.lua.org/ftp/lua-5.1.4.tar.gz<br/>tar zvfx lua-5.1.4.tar.gz<br/>cd lua-5.1.4	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		vi src/Makefile<br/>在 CFLAGS= -O2 -Wall $(MYCFLAGS) 这一行记录里加上-fPIC，更改为 CFLAGS= -O2 -Wall -fPIC $(MYCFLAGS) 来避免编译过程中出现错误。	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		make linux<br/>make install	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		cp etc/lua.pc /usr/lib/pkgconfig/<br/>export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/usr/lib/pkgconfig	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><strong>3.4 安装配置MySQL-Proxy</strong><br/>MySQL-Proxy可通过以下网址获得：<br/><a href=\"http://mysql.cdpa.nsysu.edu.tw/Downloads/MySQL-Proxy/\" target=\"_blank\"><span style=\"color:#2D83D5;\">http://mysql.cdpa.nsysu.edu.tw/Downloads/MySQL-Proxy/</span></a></p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		推荐采用已经编译好的二进制版本，因为采用源码包进行编译时，最新版的MySQL-Proxy对automake，glib以及libevent的版本都有很高的要求，而这些软件包都是系统的基础套件，不建议强行进行更新。<br/>并且这些已经编译好的二进制版本在解压后都在统一的目录内，因此建议选择以下版本：<br/>32位RHEL5平台：<br/><a href=\"http://mysql.cdpa.nsysu.edu.tw/Downloads/MySQL-Proxy/mysql-proxy-0.8.1-linux-rhel5-x86-32bit.tar.gz\" target=\"_blank\"><span style=\"color:#2D83D5;\">http://mysql.cdpa.nsysu.edu.tw/Downloads/MySQL-Proxy/mysql-proxy-0.8.1-linux-rhel5-x86-32bit.tar.gz</span></a><br/>64位RHEL5平台：<br/><a href=\"http://mysql.cdpa.nsysu.edu.tw/Downloads/MySQL-Proxy/mysql-proxy-0.8.1-linux-rhel5-x86-64bit.tar.gz\" target=\"_blank\"><span style=\"color:#2D83D5;\">http://mysql.cdpa.nsysu.edu.tw/Downloads/MySQL-Proxy/mysql-proxy-0.8.1-linux-rhel5-x86-64bit.tar.gz</span></a></p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		测试平台为RHEL5 32位，因此选择32位的软件包<br/>wget http://mysql.cdpa.nsysu.edu.tw/Downloads/MySQL-Proxy/mysql-proxy-0.8.1-linux-rhel5-x86-32bit.tar.gz	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		tar xzvf mysql-proxy-0.8.1-linux-rhel5-x86-32bit.tar.gz<br/>mv mysql-proxy-0.8.1-linux-rhel5-x86-32bit /opt/mysql-proxy	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		创建mysql-proxy服务管理脚本<br/>mkdir /opt/mysql-proxy/init.d/	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		vim mysql-proxy	</p><pre class=\"prettyprint lang-bsh\">#!/bin/sh\r\n#\r\n#&nbsp;mysql-proxy&nbsp;This&nbsp;script&nbsp;starts&nbsp;and&nbsp;stops&nbsp;the&nbsp;mysql-proxy&nbsp;daemon\r\n#\r\n#&nbsp;chkconfig:&nbsp;-&nbsp;78&nbsp;30\r\n#&nbsp;processname:&nbsp;mysql-proxy\r\n#&nbsp;description:&nbsp;mysql-proxy&nbsp;is&nbsp;a&nbsp;proxy&nbsp;daemon&nbsp;to&nbsp;mysql\r\n&nbsp;&nbsp;\r\n#&nbsp;Source&nbsp;function&nbsp;library.\r\n.&nbsp;/etc/rc.d/init.d/functions\r\n&nbsp;&nbsp;\r\n#PROXY_PATH=/usr/local/bin\r\nPROXY_PATH=/opt/mysql-proxy/bin\r\n&nbsp;&nbsp;\r\nprog=&quot;mysql-proxy&quot;\r\n&nbsp;&nbsp;\r\n#&nbsp;Source&nbsp;networking&nbsp;configuration.\r\n.&nbsp;/etc/sysconfig/network\r\n&nbsp;&nbsp;\r\n#&nbsp;Check&nbsp;that&nbsp;networking&nbsp;is&nbsp;up.\r\n[&nbsp;${NETWORKING}&nbsp;=&nbsp;&quot;no&quot;&nbsp;]&nbsp;&amp;&amp;&nbsp;exit&nbsp;0\r\n&nbsp;&nbsp;\r\n#&nbsp;Set&nbsp;default&nbsp;mysql-proxy&nbsp;configuration.\r\n#PROXY_OPTIONS=&quot;--daemon&quot;\r\nPROXY_OPTIONS=&quot;--admin-username=root&nbsp;--admin-password=password&nbsp;--proxy-read-only-backend-addresses=192.168.10.131:3306&nbsp;--proxy-backend-addresses=192.168.10.130:3306&nbsp;&nbsp;--admin-lua-script=/opt/mysql-proxy/lib/mysql-proxy/lua/admin.lua&nbsp;--proxy-lua-script=/opt/mysql-proxy/scripts/rw-splitting.lua&quot;\r\nPROXY_PID=/opt/mysql-proxy/run/mysql-proxy.pid\r\n&nbsp;&nbsp;\r\n#&nbsp;Source&nbsp;mysql-proxy&nbsp;configuration.\r\nif&nbsp;[&nbsp;-f&nbsp;/etc/sysconfig/mysql-proxy&nbsp;];&nbsp;then\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;/etc/sysconfig/mysql-proxy\r\nfi\r\n&nbsp;&nbsp;\r\nPATH=$PATH:/usr/bin:/usr/local/bin:$PROXY_PATH\r\n&nbsp;&nbsp;\r\n#&nbsp;By&nbsp;default&nbsp;it&#39;s&nbsp;all&nbsp;good\r\nRETVAL=0\r\n&nbsp;&nbsp;\r\n#&nbsp;See&nbsp;how&nbsp;we&nbsp;were&nbsp;called.\r\ncase&nbsp;&quot;$1&quot;&nbsp;in\r\n&nbsp;&nbsp;start)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Start&nbsp;daemon.\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;-n&nbsp;$&quot;Starting&nbsp;$prog:&nbsp;&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$NICELEVEL&nbsp;$PROXY_PATH/mysql-proxy&nbsp;$PROXY_OPTIONS&nbsp;--daemon&nbsp;--pid-file=$PROXY_PID&nbsp;--user=mysql&nbsp;--log-level=warning&nbsp;--log-file=/opt/mysql-proxy/log/mysql-proxy.log\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETVAL=$?\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;$RETVAL&nbsp;=&nbsp;0&nbsp;];&nbsp;then\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;touch&nbsp;/var/lock/subsys/mysql-proxy\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;\r\n&nbsp;&nbsp;stop)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Stop&nbsp;daemons.\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;-n&nbsp;$&quot;Stopping&nbsp;$prog:&nbsp;&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;killproc&nbsp;$prog\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETVAL=$?\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;$RETVAL&nbsp;=&nbsp;0&nbsp;];&nbsp;then\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rm&nbsp;-f&nbsp;/var/lock/subsys/mysql-proxy\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rm&nbsp;-f&nbsp;$PROXY_PID\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;\r\n&nbsp;&nbsp;restart)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$0&nbsp;stop\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep&nbsp;3\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$0&nbsp;start\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;\r\n&nbsp;&nbsp;condrestart)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;-e&nbsp;/var/lock/subsys/mysql-proxy&nbsp;]&nbsp;&amp;&amp;&nbsp;$0&nbsp;restart\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;\r\n&nbsp;&nbsp;status)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status&nbsp;mysql-proxy\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETVAL=$?\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;\r\n&nbsp;&nbsp;*)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;Usage:&nbsp;$0&nbsp;{start|stop|restart|status|condrestart}&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETVAL=1\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;\r\nesac\r\n&nbsp;&nbsp;\r\nexit&nbsp;$RETVAL</pre><p><br/></p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><strong>脚本参数详解：</strong><br/>==============================================<br/>PROXY_PATH=/opt/mysql-proxy/bin //定义mysql-proxy服务二进制文件路径</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">PROXY_OPTIONS=&quot;--admin-username=root \\ //定义内部管理服务器账号<br/>--admin-password=password \\ //定义内部管理服务器密码<br/>--proxy-read-only-backend-addresses=192.168.10.131:3306 \\ //定义后端只读从服务器地址<br/>--proxy-backend-addresses=192.168.10.130:3306 \\ //定义后端主服务器地址<br/>--admin-lua-script=/opt/mysql-proxy/lib/mysql-proxy/lua/admin.lua \\ //定义lua管理脚本路径<br/>--proxy-lua-script=/opt/mysql-proxy/scripts/rw-splitting.lua&quot; \\ //定义lua读写分离脚本路径</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">PROXY_PID=/opt/mysql-proxy/run/mysql-proxy.pid //定义mysql-proxy PID文件路径</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">$NICELEVEL $PROXY_PATH/mysql-proxy $PROXY_OPTIONS \\<br/>--daemon \\ //定义以守护进程模式启动<br/>--keepalive \\ //使进程在异常关闭后能够自动恢复<br/>--pid-file=$PROXY_PID \\ //定义mysql-proxy PID文件路径<br/>--user=mysql \\ //以mysql用户身份启动服务<br/>--log-level=warning \\ //定义log日志级别，由高到低分别有(error|warning|info|message|debug)<br/>--log-file=/opt/mysql-proxy/log/mysql-proxy.log //定义log日志文件路径<br/>==============================================</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">cp mysql-proxy /opt/mysql-proxy/init.d/<br/>chmod +x /opt/mysql-proxy/init.d/mysql-proxy</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">mkdir /opt/mysql-proxy/run<br/>mkdir /opt/mysql-proxy/log</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">mkdir /opt/mysql-proxy/scripts</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><strong>配置并使用rw-splitting.lua读写分离脚本</strong><br/>最新的脚本我们可以从最新的mysql-proxy源码包中获取<br/>cd /opt/install	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		wget http://mysql.cdpa.nsysu.edu.tw/Downloads/MySQL-Proxy/mysql-proxy-0.8.1.tar.gz	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		tar xzvf mysql-proxy-0.8.1.tar.gz<br/>cd mysql-proxy-0.8.1<br/>cp lib/rw-splitting.lua /opt/mysql-proxy/scripts	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		修改读写分离脚本rw-splitting.lua<br/>修改默认连接，进行快速测试，不修改的话要达到连接数为4时才启用读写分离<br/>vim /opt/mysql-proxy/scripts/rw-splitting.lua<br/>=============================<br/>-- connection pool<br/>if not proxy.global.config.rwsplit then<br/>proxy.global.config.rwsplit = {<br/>min_idle_connections = 1, //默认为4<br/>max_idle_connections = 1, //默认为8<br/>is_debug = false<br/>}<br/>end<br/>=============================	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		修改完成后，启动mysql-proxy<br/>/opt/mysql-proxy/init.d/mysql-proxy start	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><strong>3.5 测试读写分离效果</strong><br/>创建用于读写分离的数据库连接用户<br/>登陆主数据库服务器192.168.10.130，通过命令行登录管理MySQL服务器<br/>/opt/mysql/bin/mysql -uroot -p&#39;new-password&#39;<br/>mysql&gt; GRANT ALL ON *.* TO &#39;proxy1&#39;@&#39;192.168.10.132&#39; IDENTIFIED BY &#39;password&#39;;<br/>由于我们配置了主从复制功能，因此从数据库服务器192.168.10.131上已经同步了此操作。	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		为了清晰的看到读写分离的效果，需要暂时关闭MySQL主从复制功能<br/>登陆从数据库服务器192.168.10.131，通过命令行登录管理MySQL服务器<br/>/opt/mysql/bin/mysql -uroot -p&#39;new-password&#39;	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		关闭Slave同步进程<br/>mysql&gt; stop slave;<br/>Query OK, 0 rows affected (0.00 sec)	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		连接MySQL-Proxy<br/>/opt/mysql/bin/mysql -uproxy1 -p&#39;password&#39; -P4040 -h192.168.10.132	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		登陆成功后，在first_db数据的first_tb表中插入两条记录<br/>mysql&gt; use first_db;<br/>Database changed<br/>mysql&gt; REPLACE INTO first_tb values (007,’first’);<br/>Query Ok, 1 row affected (0.00 sec)<br/>mysql&gt; REPLACE INTO first_tb values (110,’second’);<br/>Query Ok, 1 row affected (0.00 sec)	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		查询记录<br/>mysql&gt; select * from first_tb;<br/>=============================<br/>+------+------+<br/>| id | name |<br/>+------+------+<br/>| 1 | myself |<br/>+------+------+<br/>1 rows in set (0.00 sec)<br/>=============================<br/>通过读操作并没有看到新记录	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		mysql&gt; quit<br/>退出MySQL-Proxy	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		下面，分别登陆到主从数据库服务器，对比记录信息<br/>首先，检查主数据库服务器<br/>mysql&gt; select * from first_tb;<br/>=============================<br/>+------+------+<br/>| id | name |<br/>+------+------+<br/>| 1 | myself |<br/>+------+------+<br/>| 007 | first |<br/>+------+------+<br/>| 110 | second |<br/>+------+------+<br/>3 rows in set (0.00 sec)<br/>=============================<br/>两条新记录都已经存在	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		然后，检查从数据库服务器<br/>mysql&gt; select * from first_tb;<br/>=============================<br/>+------+------+<br/>| id | name |<br/>+------+------+<br/>| 1 | myself |<br/>+------+------+<br/>1 rows in set (0.00 sec)<br/>=============================<br/>没有新记录存在	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		由此验证，我们已经实现了MySQL读写分离，目前所有的写操作都全部在Master主服务器上，用来避免数据的不同步；<br/>另外，所有的读操作都分摊给了其它各个Slave从服务器上，用来分担数据库压力。	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\"><strong>经验分享：</strong><br/>1.当MySQL主从复制在 show slave status\\G 时出现Slave_IO_Running或Slave_SQL_Running 的值不为YES时，需要首先通过 stop slave 来停止从服务器，然后再执行一次本文 2.1与2.2 章节中的步骤即可恢复，但如果想尽可能的同步更多的数据，可以在Slave上将master_log_pos节点的值在之前同步失效的值的基础上增大一 些，然后反复测试，直到同步OK。因为MySQL主从复制的原理其实就是从服务器读取主服务器的binlog，然后根据binlog的记录来更新数据库。	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		2.MySQL-Proxy的rw-splitting.lua脚本在网上有很多版本，但是最准确无误的版本仍然是源码包中所附带的lib/rw-splitting.lua脚本，如果有lua脚本编程基础的话，可以在这个脚本的基础上再进行优化；	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		3.MySQL-Proxy实际上非常不稳定，在高并发或有错误连接的情况下，进程很容易自动关闭，因此打开--keepalive参数让进程自动 恢复是个比较好的办法，但还是不能从根本上解决问题，因此通常最稳妥的做法是在每个从服务器上安装一个MySQL-Proxy供自身使用，虽然比较低效但 却能保证稳定性；	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		4.一主多从的架构并不是最好的架构，通常比较优的做法是通过程序代码和中间件等方面，来规划，比如设置对表数据的自增id值差异增长等方式来实现两个或多个主服务器，但一定要注意保证好这些主服务器数据的完整性，否则效果会比多个一主多从的架构还要差；	</p><p style=\"color:#000000;font-family:Tahoma;font-style:normal;font-weight:normal;text-align:-webkit-auto;text-indent:0px;font-size:medium;\">\r\n		5.MySQL-Cluster 的稳定性也不是太好；	</p><p>\r\n		6.Amoeba for MySQL 是一款优秀的中间件软件，同样可以实现读写分离，负载均衡等功能，并且稳定性要大大超过MySQL-Proxy，建议大家用来替代MySQL-Proxy，甚至MySQL-Cluster。 <br/></p><hr/><p style=\"text-indent:2em;\">相关文章：</p><p style=\"text-indent:2em;\"><a href=\"http://www.yiifcms.com/post/35/\" title=\"Mysql基本用法\" target=\"_blank\" style=\"\">Mysql基本用法</a></p><p style=\"text-indent:2em;\"><a href=\"http://www.yiifcms.com/post/34/\" title=\"mysql的数据类型int、bigint、smallint 和 tinyint取值范围\" target=\"_blank\" style=\"\">mysql的数据类型int、bigint、smallint 和 ...</a></p><p style=\"text-indent:2em;\"><br/></p>','','','','mysql,html,sql,yii,linux,cms,文章,IT,服务器',39,'N','N','','',0,0,'N',1408692627,0,'Y',0,'Y',1407480819),
	(38,1,'关于人人网开发平台提供的sdk的问题','','','','',20,0,'今天做人人网登录接口的时候 下来官网的sdk  发现里面有个很低级的错误 导致获取token的时候 老是失败      先分析下：          1.   rennclient/RennClientBase.php 文件中 的 authWithAuthorizationCode函数：                   /** * 用code来授权：通过code来获得token * * @param string $code */ public function authWithAuthorizationCode($code, $redirectUri) { $keys = array (); $keys [&#039;code&#039;]...','','','','','<p>\r\n	<span style=\"font-size:14px;\">今天做人人网登录接口的时候 下来官网的sdk&nbsp; 发现里面有个很低级的错误 导致获取token的时候 老是失败</span>\r\n</p>\r\n<p>\r\n	<br />\r\n</p>\r\n<p>\r\n	<span style=\"font-size:14px;\">先分析下：&nbsp; <br />\r\n</span>\r\n</p>\r\n<p>\r\n	<span style=\"font-size:14px;\">&nbsp; 1.&nbsp;&nbsp; rennclient/RennClientBase.php 文件中 的 authWithAuthorizationCode函数：</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</p>\r\n<pre class=\"prettyprint lang-php\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n	 * 用code来授权：通过code来获得token\r\n	 *\r\n	 * @param string $code        	\r\n	 */\r\n	public function authWithAuthorizationCode($code, $redirectUri) {\r\n		$keys = array ();\r\n		$keys [\'code\'] = $code;\r\n		$keys [\'redirect_uri\'] = $redirectUri;\r\n		try {\r\n			// 根据code来获得token\r\n			$token = $this-&gt;getTokenFromTokenEndpoint ( \'code\', $keys );\r\n			\r\n		} catch ( RennException $e ) {\r\n			throw new InvalideAuthorizationException ( \"Authorization failed with Authorization Code. \" . $e-&gt;getMessage () );\r\n		}\r\n	}</pre>\r\n&nbsp;&nbsp;&nbsp;<span style=\"font-size:14px;\">&nbsp;&nbsp; 这是一个公有方法public ,再看getTokenFromTokenEndpoint函数：</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n<pre class=\"prettyprint lang-php\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n	 * 从token endpoint获得token\r\n	 *\r\n	 * @param string $grantType\r\n	 *        	请求的类型,可以为:code, password, token\r\n	 * @param array $keys\r\n	 *        	其他参数：\r\n	 *        	- 当$grant_type为code时： array(\'code\'=&gt;..., \'redirect_uri\'=&gt;...)\r\n	 *        	- 当$grant_type为password时： array(\'username\'=&gt;..., \'password\'=&gt;...)\r\n	 *        	- 当$grant_type为token时： array(\'refresh_token\'=&gt;...)\r\n	 * @param\r\n	 *        	string token_type token的类型,可以为:bearer,mac\r\n	 * @return array\r\n	 */\r\n	private function getTokenFromTokenEndpoint($grantType, $keys, $tokenType = TokenType::MAC) {\r\n		$params = array ();</pre>\r\n<p>\r\n	<br />\r\n</p>\r\n<p>\r\n	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"font-size:14px;\">&nbsp;&nbsp; 这是一个私有方法private</span><span id=\"__kindeditor_bookmark_start_51__\"> </span><span style=\"font-size:14px;\">,&nbsp; demo里面的callback.php:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</p>\r\n<pre class=\"prettyprint lang-php\">&nbsp;&nbsp;&nbsp;&nbsp;$rennClient = new RennClient ( APP_KEY, APP_SECRET );\r\n&nbsp;&nbsp;&nbsp;&nbsp;$rennClient-&gt;setDebug ( DEBUG_MODE );\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;// 处理code -- 根据code来获得token\r\n&nbsp;&nbsp;&nbsp;&nbsp;if (isset ( $_REQUEST [\'code\'] )) {\r\n	$keys = array ();\r\n	\r\n	// 验证state，防止伪造请求跨站攻击\r\n	$state = $_REQUEST [\'state\'];\r\n	if (empty ( $state ) || $state !== $_SESSION [\'renren_state\']) {\r\n		echo \'非法请求！\';\r\n		exit ();\r\n	}\r\n	unset ( $_SESSION [\'renren_state\'] );\r\n	\r\n	// 获得code\r\n	$keys [\'code\'] = $_REQUEST [\'code\'];\r\n	$keys [\'redirect_uri\'] = CALLBACK_URL;\r\n	try {\r\n		// 根据code来获得token\r\n		$token = $rennClient-&gt;getTokenFromTokenEndpoint ( \'code\', $keys );\r\n	} catch ( RennException $e ) {\r\n		var_dump ( $e );\r\n	}\r\n}</pre>\r\n<p>\r\n	&nbsp;&nbsp; <span style=\"font-size:14px;\">仔细看会发现，$rennClient对象访问了getTokenFromTokenEndpoint</span><span style=\"font-size:14px;\" id=\"__kindeditor_bookmark_start_78__\">()方法，这很明显是不对的。私有方法是不能在外部使用的。于是我找到了一个公有方法获取token,就是上面的那个authWithAuthorizationCode()&nbsp; 原以为这样就可以了 但是还是没有token 仔细看了这个函数 竟然没有返回值？&nbsp; 这。。。 难道不对 ？由找了这个方法的其他用途 发现没有。这很明显也是个低级错误，吐槽了一下，加个返回值 return&nbsp; $token;吧 。</span>\r\n</p>\r\n<p>\r\n	&nbsp;\r\n</p>\r\n<pre class=\"prettyprint lang-php\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n	 * 用code来授权：通过code来获得token\r\n	 *\r\n	 * @param string $code        	\r\n	 */\r\n	public function authWithAuthorizationCode($code, $redirectUri) {\r\n		$keys = array ();\r\n		$keys [\'code\'] = $code;\r\n		$keys [\'redirect_uri\'] = $redirectUri;\r\n		try {\r\n			// 根据code来获得token\r\n			$token = $this-&gt;getTokenFromTokenEndpoint ( \'code\', $keys );\r\n			return $token;\r\n		} catch ( RennException $e ) {\r\n			throw new InvalideAuthorizationException ( \"Authorization failed with Authorization Code. \" . $e-&gt;getMessage () );\r\n		}\r\n	}</pre>\r\n&nbsp;\r\n<p>\r\n	<br />\r\n</p>\r\n<p>\r\n	<span id=\"__kindeditor_bookmark_start_78__\">&nbsp;&nbsp;<span style=\"font-size:14px;\"> 哈哈，结果就是成功了！</span></span><span style=\"font-size:14px;\">&nbsp;&nbsp; </span>\r\n</p>\r\n<p>\r\n	<span style=\"font-size:14px;\">&nbsp;&nbsp; 分享出来，奉献给需要的童鞋们吧！</span>\r\n</p>\r\n<p>\r\n	<br />\r\n</p>\r\n<p>\r\n	============================by 惜暮(Sim) &lt;326196998@qq.com&gt;===========================\r\n</p>','原创','http://www.yiifcms/post/','','php,接口,人人网',36,'N','N','','',2,1,'N',1408091448,0,'Y',0,'Y',1408091323),
	(39,1,' yii 操作cookie的用法详解','','','','',20,0,'设置cookie:    $cookie = new CHttpCookie(&#039;mycookie&#039;,&#039;this is my cookie&#039;); $cookie-&gt;expire = time()+60*60*24*30; //有限期30天 Yii::app()-&gt;request-&gt;cookies[&#039;mycookie&#039;]=$cookie; 读取cookie:   $cookie = Yii::app()-&gt;request-&gt;getCookies(); echo $cookie[&#039;mycookie&#039;]-&gt;value;  销毁cookie:   $cookie = Yii::app()-&gt;request-&gt;getCookies(); unset($cookie[$name]);       ==========================by 惜暮(Sim) &lt;326...','','','','','<p>\r\n	<span style=\"line-height:22px;color:#002200;font-family:georgia;font-size:16px;\">设置cookie:</span>\r\n</p>\r\n<p>\r\n<pre class=\"prettyprint lang-php\"> $cookie = new CHttpCookie(\'mycookie\',\'this is my cookie\');\r\n $cookie-&gt;expire = time()+60*60*24*30;  //有限期30天\r\n Yii::app()-&gt;request-&gt;cookies[\'mycookie\']=$cookie;</pre>\r\n<span style=\"font-size:16px;\">读取cookie:</span>\r\n</p>\r\n<p>\r\n<pre class=\"prettyprint lang-php\">$cookie = Yii::app()-&gt;request-&gt;getCookies();\r\necho $cookie[\'mycookie\']-&gt;value;\r\n</pre>\r\n<span style=\"font-size:16px;\">销毁cookie:</span>\r\n</p>\r\n<p>\r\n<pre class=\"prettyprint lang-php\">$cookie = Yii::app()-&gt;request-&gt;getCookies();\r\nunset($cookie[$name]);\r\n</pre>\r\n</p>\r\n<p>\r\n	<br />\r\n</p>\r\n<p>\r\n	==========================by&nbsp;惜暮(Sim) &lt;326196998@qq.com&gt; ====================<br />\r\n<span style=\"line-height:22px;color:#002200;font-family:georgia;font-size:16px;\"></span><span style=\"font-size:14px;\"></span>\r\n</p>','csdn','http://blog.csdn.net/xiaojun1288/article/details/7351626','','php,yii',23,'N','N','','',0,0,'N',1408108154,0,'Y',0,'Y',1408108154),
	(40,1,'nginx+apache反向代理配置详解','','','','',3,0,'很早就了解到nginx用作反向代理服务器，结合Apache，如今我也试着配置了一下，很荣幸成功了，下面详解下安装与配置   1.  先安装Apache，我采用编译安装     wget http://mirrors.hust.edu.cn/apache/httpd/httpd-2.4.10.tar.gz tar -zxvf httpd-2.4.10.tar.gz cd httpd-2.4.10 ./configure --prefix=/usr/local/apache --with-apr=/usr/local/apr --with-apr-util=/usr/local/apr-util --enable-so --enable-mods-shared=most --...','','','','','<p style=\"text-indent:2em;\">\r\n	<span style=\"font-size:14px;\">很早就了解到nginx用作反向代理服务器，结合Apache，如今我也试着配置了一下，很荣幸成功了，下面详解下安装与配置</span> \r\n</p>\r\n<p style=\"text-indent:2em;\">\r\n	<strong><span style=\"font-size:14px;\">1.&nbsp; 先安装Apache，我采用编译安装</span></strong> \r\n</p>\r\n<pre class=\"prettyprint lang-bsh\">wget http://mirrors.hust.edu.cn/apache/httpd/httpd-2.4.10.tar.gz\r\ntar -zxvf httpd-2.4.10.tar.gz\r\ncd httpd-2.4.10\r\n./configure --prefix=/usr/local/apache --with-apr=/usr/local/apr --with-apr-util=/usr/local/apr-util --enable-so --enable-mods-shared=most --with-mpm=worker \r\nmake &amp;&amp; make install</pre>\r\n<p style=\"text-indent:2em;\">\r\n	#首先以apachectl脚本为模板生成Apache服务控制脚本：\r\n</p>\r\n<pre class=\"prettyprint lang-bsh\">grep -v \"#\" /usr/local/apache/bin/apachectl  &gt; /etc/init.d/apache </pre>\r\n<p style=\"text-indent:2em;\">\r\n	用vi编辑Apache服务控制脚本/etc/init.d/apache：\r\n</p>\r\n<pre class=\"prettyprint lang-bsh\"> vi /etc/init.d/apache </pre>\r\n在文件最前面插入下面的行，使其支持chkconfig命令：\r\n<pre class=\"prettyprint lang-bsh\">#!/bin/sh\r\n# chkconfig: 2345 85 15\r\n# description: Apache is a World Wide Web server. </pre>\r\n保存后退出vi编辑器，执行下面的命令增加Apache服务控制脚本执行权限：\r\n<pre class=\"prettyprint lang-bsh\">chmod  +x  /etc/init.d/apache </pre>\r\n执行下面的命令将Apache服务加入到系统服务：\r\n<pre class=\"prettyprint lang-bsh\">chkconfig --add apache </pre>\r\n执行下面的命令检查Apache服务是否已经生效：\r\n<pre class=\"prettyprint lang-bsh\">chkconfig --list apache </pre>\r\n命令输出类似下面的结果：\r\n<pre class=\"prettyprint lang-bsh\">apache          0:off 1:off 2:on 3:on 4:on 5:on 6:off </pre>\r\n<p>\r\n	表明apache服务已经生效，在2、3、4、5运行级别随系统启动而自动启动，以后可以使用service命令控制Apache的启动和停止\r\n</p>\r\n<p>\r\n	<br />\r\n</p>\r\n<p>\r\n	配置apache 端口8080 修改httpd.conf\r\n</p>\r\n<p>\r\n<pre class=\"prettyprint lang-bsh\">Listen 8080\r\nServerName localhost</pre>\r\n</p>\r\n<p style=\"text-indent:2em;\">\r\n	<strong><span style=\"font-size:14px;\">2. 编译安装php5.5.14</span></strong> \r\n</p>\r\n<div>\r\n	<div>\r\n		<span style=\"line-height:1;\">首先是编译准备工作：&nbsp;</span> \r\n	</div>\r\n	<div>\r\n<pre>\r\n\r\n<pre class=\"prettyprint lang-bsh\">yum groupinstall \"Development tools\"\r\n</pre>\r\n</pre>\r\n<pre>然后是编译安装 PHP 5.5.x 需要用到的 devel 包：\r\n<pre class=\"prettyprint lang-bsh\">yum install libxml2-devel gd-devel libmcrypt-devel libcurl-devel openssl-devel \r\n</pre>\r\n</pre>\r\n<pre>从官方下载，解压：\r\n<pre class=\"prettyprint lang-bsh\">wget http://cn2.php.net/get/php-5.5.14.tar.gz/from/this/mirror\r\ntar -xvf php-5.5.14.tar.gz\r\ncd php-5.5.14 \r\n</pre>\r\n</pre>\r\n<pre>编译安装 php 5.5 的参数(如果内存大于1G可以去除--disable-fileinfo)：\r\n<pre class=\"prettyprint lang-bsh\">./configure --prefix=/usr/local/php-5.5.14 <span class=\"top11\">--with-config-file-path</span>=/etc/ --with-apxs2=/usr/local/apache/bin/apxs --with-iconv=/usr/local/ –disable-fileinfo --disable-cli --enable-shared --with-libxml-dir --with-gd --with-openssl --enable-mbstring --with-mcrypt --with-mysqli --with-mysql --enable-opcache --enable-mysqlnd --enable-zip --with-zlib-dir --with-pdo-mysql --with-jpeg-dir --with-freetype-dir --with-curl --without-pdo-sqlite --without-sqlite3</pre>\r\n开始编译安装\r\n<pre class=\"prettyprint lang-bsh\">make\r\nmake install \r\n\r\n</pre>\r\n3.配置nginx.conf 使之反向代理<br />\r\n<pre class=\"prettyprint lang-bsh\">server {\r\n    listen       80;\r\n    server_name  demo.yiifcms.com;\r\n    index index.html index.htm index.php;\r\n    root /alidata/www/demo.yiifcms.com;\r\n    location ~ .*\\.(php|php5)?$\r\n    {\r\n        proxy_pass        http://127.0.0.1:8080;\r\n\r\n        proxy_set_header  X-Real-IP  $remote_addr;\r\n        proxy_connect_timeout 300s;\r\n        proxy_send_timeout 900;\r\n        proxy_read_timeout 900;\r\n        proxy_buffer_size 32k;\r\n        proxy_buffers 4 64k;\r\n        proxy_busy_buffers_size 128k;\r\n        proxy_redirect off;\r\n        proxy_hide_header Vary;\r\n        proxy_set_header Accept-Encoding \'\';\r\n        proxy_set_header Referer $http_referer;\r\n        proxy_set_header Cookie $http_cookie;\r\n        proxy_set_header Host $host;\r\n        proxy_set_header X-Real-IP $remote_addr;\r\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n\r\n    }\r\n    #location ~ .*\\.(php|php5)?$\r\n    #{\r\n    #   fastcgi_pass  127.0.0.1:9000;\r\n    #   fastcgi_index index.php;\r\n    #   include fastcgi.conf;\r\n    #}\r\n    location ~ .*\\.(gif|jpg|jpeg|png|bmp|swf)$\r\n    {\r\n        expires 30d;\r\n    }\r\n    location ~ .*\\.(js|css)?$\r\n    {\r\n        expires 30d;\r\n    }\r\n    access_log  /alidata/log/nginx/access/demo.yiifcms.com.log default;\r\n}\r\n</pre>\r\n&nbsp;</pre>\r\n	</div>\r\n</div>','','','','php,mysql,web,html,js,sql,apache,nginx,yii,cms',48,'N','N','','',0,0,'N',1408429775,0,'Y',0,'Y',1408428291),
	(41,1,'yii框架下使用ueditor插件详解','','','','',20,0,'用了一段时间的KindEditor, 虽然功能还不错，但编辑时的代码插入不方便，索性就换了个百度的Ueditor，结合自己的yiifmcs网站，也顺利的搭建成功了，下面分享下步骤：下载Ueditor (http://ueditor.baidu.com/website/)解压后，放到新建的widget/ueditor目录下，结构如图：去除一些无用的文件,可以看到ueditor下新建了Ueditor.php文件，作为widget的运行程序：    Ueditor.php&lt;?php /**  * YiifCMS Ueditor Widget  *  * ...','','','','','<p><span style=\"font-size: 16px;\">用了一段时间的KindEditor, 虽然功能还不错，但编辑时的代码插入不方便，索性就换了个百度的Ueditor，结合自己的yiifcms网站，也顺利的搭建成功了，下面分享下步骤：</span></p><p><span style=\"font-size: 16px;\">1. 下载Ueditor (</span><a style=\"font-size: 16px; text-decoration: underline;\" title=\"Ueditor\" target=\"_blank\" href=\"http://ueditor.baidu.com/website/\"><span style=\"font-size: 16px;\">http://ueditor.baidu.com/website/</span></a><span style=\"font-size: 16px;\">)<br/></span></p><p><span style=\"font-size: 16px;\">2. 解压后，放到新建的widget/ueditor目录下，结构如图：</span></p><p><img alt=\"1.png\" src=\"/uploads/ueditor/image/20140820/1408525452904809.png\" title=\"1408525452904809.png\"/></p><p><br/></p><p><span style=\"font-size: 16px;\">3. 去除一些无用的文件,可以看到ueditor下新建了Ueditor.php文件，作为widget的运行程序：<br/></span></p><p><span style=\"font-size: 16px;\">&nbsp;&nbsp;&nbsp;&nbsp;Ueditor.php</span></p><pre class=\"brush:php;toolbar:false\">&lt;?php\r\n/**\r\n&nbsp;*&nbsp;YiifCMS&nbsp;Ueditor&nbsp;Widget\r\n&nbsp;*\r\n&nbsp;*&nbsp;@author&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sim&nbsp;&lt;326196998@qq.com&gt;\r\n&nbsp;*&nbsp;@copyright&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Copyright&nbsp;(c)&nbsp;2007-2013&nbsp;bagesoft.&nbsp;All&nbsp;rights&nbsp;reserved.\r\n&nbsp;*&nbsp;@link&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://www.yiifcms.com\r\n&nbsp;*&nbsp;@package&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YiiCMS.Widget\r\n&nbsp;*&nbsp;@license&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://www.yiifcms.com/license\r\n&nbsp;*&nbsp;@version&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v1.0.0\r\n&nbsp;*&nbsp;@example&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;widget(&#39;application.widget.ueditor.Ueditor&#39;,\r\n&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(&#39;htmlOptions&#39;=&gt;\r\n&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(\r\n&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;=&gt;&#39;Post_content&#39;,//页面中输入框（或其他初始化容器）的ID\r\n&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;name&#39;=&gt;&#39;editor&#39;,//指定ueditor实例的名称,个页面有多个ueditor实例时使用\r\n&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;config&#39;=&gt;&nbsp;array(\r\n&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;initialFrameHeight&#39;=&gt;&#39;400&#39;,\r\n&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;initialFrameWidth&#39;=&gt;&#39;80%&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\r\n&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)\r\n&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)\r\n&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);\r\n&nbsp;*/\r\n\r\nclass&nbsp;Ueditor&nbsp;extends&nbsp;CInputWidget{\r\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;$language&nbsp;=&nbsp;&#39;zh-cn&#39;;\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;获取资源文件路径\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;[type]&nbsp;[description]\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;getAssetsPath()&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$baseDir&nbsp;=&nbsp;dirname(&nbsp;__FILE__&nbsp;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Yii::app()-&gt;getAssetManager()-&gt;publish(&nbsp;$baseDir.DIRECTORY_SEPARATOR.&#39;assets&#39;&nbsp;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;生成编辑器\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;[type]&nbsp;[description]\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;makeOptions()&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$id&nbsp;=&nbsp;$this-&gt;htmlOptions[&#39;id&#39;];\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$name&nbsp;=&nbsp;$this-&gt;htmlOptions[&#39;name&#39;];\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$config&nbsp;=&nbsp;$this-&gt;htmlOptions[&#39;config&#39;];\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$systemDefault&nbsp;=&nbsp;$this-&gt;combineParams(&nbsp;$config&nbsp;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script&nbsp;=&nbsp;&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;{$name}&nbsp;=&nbsp;UE.getEditor(&#39;&quot;.$id.&quot;&#39;,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;serverUrl&#39;:&nbsp;&#39;&quot;.Yii::app()-&gt;createUrl(&#39;/admin/ueditor&#39;).&quot;&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$systemDefault\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$script;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;组合参数\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;[type]&nbsp;&nbsp;$items&nbsp;[description]\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;[type]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[description]\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;function&nbsp;combineParams(&nbsp;$items&nbsp;)&nbsp;{\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script&nbsp;=&nbsp;&#39;&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(&nbsp;(array)$items&nbsp;as&nbsp;$key&nbsp;=&gt;&nbsp;$item&nbsp;)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;is_array(&nbsp;$item&nbsp;)&nbsp;)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;self::_checkType(&nbsp;$item&nbsp;)&nbsp;==&nbsp;&#39;arr&#39;&nbsp;)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script&nbsp;.=&nbsp;$dot&nbsp;.self::_arr(&nbsp;$key,&nbsp;$item&nbsp;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script&nbsp;.=&nbsp;$dot&nbsp;.self::_obj($key,&nbsp;$item);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script&nbsp;.=&nbsp;&nbsp;$dot&nbsp;.&quot;&#39;$key&#39;:&#39;$item&#39;&nbsp;&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$dot&nbsp;=&nbsp;&quot;,\\n&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$script;\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;检测类型\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;function&nbsp;_checkType(&nbsp;$var&nbsp;)&nbsp;{\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;gettype(&nbsp;$var&nbsp;)&nbsp;==&nbsp;&#39;array&#39;&nbsp;)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&#39;arr&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&#39;obj&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;对象\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;function&nbsp;_obj(&nbsp;$key,&nbsp;$item)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script&nbsp;.=&nbsp;&nbsp;$dot&nbsp;.&quot;&#39;$key&#39;:{&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subDot&nbsp;=&nbsp;&#39;&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(&nbsp;$item&nbsp;as&nbsp;$keys=&gt;$value&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$arrkeys&nbsp;=&nbsp;array_keys($value);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach($arrkeys&nbsp;as&nbsp;$row){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script&nbsp;.=&nbsp;$subDot.&nbsp;&quot;&#39;$row&#39;:&#39;{$value[$row]}&#39;&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subDot&nbsp;=&nbsp;&quot;,&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script&nbsp;.=&quot;}&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$script;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;数组\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;function&nbsp;_arr(&nbsp;$key,&nbsp;$item&nbsp;)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script&nbsp;.=&nbsp;&nbsp;$dot&nbsp;.&quot;&#39;$key&#39;:[&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subDot&nbsp;=&nbsp;&#39;&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(&nbsp;$item&nbsp;as&nbsp;$value&nbsp;)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script&nbsp;.=&nbsp;$subDot.&nbsp;&quot;&#39;$value&#39;&nbsp;&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subDot&nbsp;=&nbsp;&quot;,&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script&nbsp;.=&quot;]&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$script;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;运行\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;run()&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent::run();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$assets&nbsp;=&nbsp;$this-&gt;getAssetsPath();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$clientScript&nbsp;=&nbsp;Yii::app()-&gt;getClientScript();&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$clientScript-&gt;registerScriptFile(&nbsp;$assets.&#39;/ueditor.config.js&#39;,&nbsp;CClientScript::POS_END&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$clientScript-&gt;registerScriptFile(&nbsp;$assets.&#39;/ueditor.all.min.js&#39;,&nbsp;CClientScript::POS_END&nbsp;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$clientScript-&gt;registerScriptFile(&nbsp;$assets.&#39;/lang/&#39;.$this-&gt;language.&#39;/&#39;.$this-&gt;language.&#39;.js&#39;,&nbsp;CClientScript::POS_END&nbsp;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$clientScript-&gt;registerScript(&nbsp;&#39;content&#39;,&nbsp;$this-&gt;makeOptions(),&nbsp;CClientScript::POS_END&nbsp;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n}\r\n?&gt;</pre><p><br/></p><p><span style=\"font-size: 16px;\">4. 增加extensions/ueditor, 目录结构如下：</span></p><p>&nbsp; <img alt=\"1408525680877264.jpg\" src=\"/uploads/ueditor/image/20140820/1408525680877264.jpg\" title=\"1408525680877264.jpg\"/></p><p>&nbsp;&nbsp; <br/></p><p>&nbsp;&nbsp; <span style=\"font-size: 16px;\">UeditorUploader.class.php文件：</span></p><pre class=\"brush:php;toolbar:false\">&lt;?php\r\n\r\n/**\r\n&nbsp;*&nbsp;Created&nbsp;by&nbsp;JetBrains&nbsp;PhpStorm.\r\n&nbsp;*&nbsp;User:&nbsp;taoqili\r\n&nbsp;*&nbsp;Date:&nbsp;12-7-18\r\n&nbsp;*&nbsp;Time:&nbsp;上午11:&nbsp;32\r\n&nbsp;*&nbsp;UEditor编辑器通用上传类\r\n&nbsp;*/\r\nclass&nbsp;UeditorUploader\r\n{\r\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$fileField;&nbsp;//文件域名\r\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$file;&nbsp;//文件上传对象\r\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$base64;&nbsp;//文件上传对象\r\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$config;&nbsp;//配置信息\r\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$oriName;&nbsp;//原始文件名\r\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$fileName;&nbsp;//新文件名\r\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$fullName;&nbsp;//完整文件名,即从当前配置目录开始的URL\r\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$filePath;&nbsp;//完整文件名,即从当前配置目录开始的URL\r\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$fileSize;&nbsp;//文件大小\r\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$fileType;&nbsp;//文件类型\r\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$stateInfo;&nbsp;//上传状态信息,\r\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$stateMap&nbsp;=&nbsp;array(&nbsp;//上传状态映射表，国际化用户需考虑此处数据的国际化\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;SUCCESS&quot;,&nbsp;//上传成功标记，在UEditor中内不可改变，否则flash判断会出错\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;文件大小超出&nbsp;upload_max_filesize&nbsp;限制&quot;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;文件大小超出&nbsp;MAX_FILE_SIZE&nbsp;限制&quot;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;文件未被完整上传&quot;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;没有文件被上传&quot;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;上传文件为空&quot;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ERROR_TMP_FILE&quot;&nbsp;=&gt;&nbsp;&quot;临时文件错误&quot;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ERROR_TMP_FILE_NOT_FOUND&quot;&nbsp;=&gt;&nbsp;&quot;找不到临时文件&quot;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ERROR_SIZE_EXCEED&quot;&nbsp;=&gt;&nbsp;&quot;文件大小超出网站限制&quot;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ERROR_TYPE_NOT_ALLOWED&quot;&nbsp;=&gt;&nbsp;&quot;文件类型不允许&quot;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ERROR_CREATE_DIR&quot;&nbsp;=&gt;&nbsp;&quot;目录创建失败&quot;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ERROR_DIR_NOT_WRITEABLE&quot;&nbsp;=&gt;&nbsp;&quot;目录没有写权限&quot;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ERROR_FILE_MOVE&quot;&nbsp;=&gt;&nbsp;&quot;文件保存时出错&quot;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ERROR_FILE_NOT_FOUND&quot;&nbsp;=&gt;&nbsp;&quot;找不到上传文件&quot;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ERROR_WRITE_CONTENT&quot;&nbsp;=&gt;&nbsp;&quot;写入文件内容错误&quot;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ERROR_UNKNOWN&quot;&nbsp;=&gt;&nbsp;&quot;未知错误&quot;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ERROR_DEAD_LINK&quot;&nbsp;=&gt;&nbsp;&quot;链接不可用&quot;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ERROR_HTTP_LINK&quot;&nbsp;=&gt;&nbsp;&quot;链接不是http链接&quot;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ERROR_HTTP_CONTENTTYPE&quot;&nbsp;=&gt;&nbsp;&quot;链接contentType不正确&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;);\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;构造函数\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$fileField&nbsp;表单名称\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;array&nbsp;$config&nbsp;配置项\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;bool&nbsp;$base64&nbsp;是否解析base64编码，可省略。若开启，则$fileField代表的是base64编码的字符串表单名\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;__construct($fileField,&nbsp;$config,&nbsp;$type&nbsp;=&nbsp;&quot;upload&quot;)\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;fileField&nbsp;=&nbsp;$fileField;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;config&nbsp;=&nbsp;$config;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;type&nbsp;=&nbsp;$type;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($type&nbsp;==&nbsp;&quot;remote&quot;)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;saveRemote();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if($type&nbsp;==&nbsp;&quot;base64&quot;)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;upBase64();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;upFile();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateMap[&#39;ERROR_TYPE_NOT_ALLOWED&#39;]&nbsp;=&nbsp;iconv(&#39;unicode&#39;,&nbsp;&#39;utf-8&#39;,&nbsp;$this-&gt;stateMap[&#39;ERROR_TYPE_NOT_ALLOWED&#39;]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;上传文件的主处理方法\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;mixed\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;upFile()\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$file&nbsp;=&nbsp;$this-&gt;file&nbsp;=&nbsp;$_FILES[$this-&gt;fileField];\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!$file)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_FILE_NOT_FOUND&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($this-&gt;file[&#39;error&#39;])&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo($file[&#39;error&#39;]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(!file_exists($file[&#39;tmp_name&#39;]))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_TMP_FILE_NOT_FOUND&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(!is_uploaded_file($file[&#39;tmp_name&#39;]))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_TMPFILE&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;oriName&nbsp;=&nbsp;$file[&#39;name&#39;];\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;fileSize&nbsp;=&nbsp;$file[&#39;size&#39;];\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;fileType&nbsp;=&nbsp;$this-&gt;getFileExt();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;fullName&nbsp;=&nbsp;$this-&gt;getFullName();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;filePath&nbsp;=&nbsp;$this-&gt;getFilePath();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;fileName&nbsp;=&nbsp;$this-&gt;getFileName();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$dirname&nbsp;=&nbsp;dirname($this-&gt;filePath);\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//检查文件大小是否超出限制\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!$this-&gt;checkSize())&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_SIZE_EXCEED&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//检查是否不允许的文件格式\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!$this-&gt;checkType())&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_TYPE_NOT_ALLOWED&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//创建目录失败\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!file_exists($dirname)&nbsp;&amp;&amp;&nbsp;!mkdir($dirname,&nbsp;0777,&nbsp;true))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_CREATE_DIR&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(!is_writeable($dirname))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_DIR_NOT_WRITEABLE&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//移动文件\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!(move_uploaded_file($file[&quot;tmp_name&quot;],&nbsp;$this-&gt;filePath)&nbsp;&amp;&amp;&nbsp;file_exists($this-&gt;filePath)))&nbsp;{&nbsp;//移动失败\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_FILE_MOVE&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{&nbsp;//移动成功\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;stateMap[0];\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;处理base64编码的图片上传\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;mixed\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;upBase64()\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$base64Data&nbsp;=&nbsp;$_POST[$this-&gt;fileField];\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$img&nbsp;=&nbsp;base64_decode($base64Data);\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;oriName&nbsp;=&nbsp;$this-&gt;config[&#39;oriName&#39;];\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;fileSize&nbsp;=&nbsp;strlen($img);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;fileType&nbsp;=&nbsp;$this-&gt;getFileExt();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;fullName&nbsp;=&nbsp;$this-&gt;getFullName();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;filePath&nbsp;=&nbsp;$this-&gt;getFilePath();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;fileName&nbsp;=&nbsp;$this-&gt;getFileName();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$dirname&nbsp;=&nbsp;dirname($this-&gt;filePath);\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//检查文件大小是否超出限制\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!$this-&gt;checkSize())&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_SIZE_EXCEED&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//创建目录失败\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!file_exists($dirname)&nbsp;&amp;&amp;&nbsp;!mkdir($dirname,&nbsp;0777,&nbsp;true))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_CREATE_DIR&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(!is_writeable($dirname))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_DIR_NOT_WRITEABLE&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//移动文件\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!(file_put_contents($this-&gt;filePath,&nbsp;$img)&nbsp;&amp;&amp;&nbsp;file_exists($this-&gt;filePath)))&nbsp;{&nbsp;//移动失败\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_WRITE_CONTENT&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{&nbsp;//移动成功\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;stateMap[0];\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;拉取远程图片\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;mixed\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;saveRemote()\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$imgUrl&nbsp;=&nbsp;htmlspecialchars($this-&gt;fileField);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$imgUrl&nbsp;=&nbsp;str_replace(&quot;&amp;amp;&quot;,&nbsp;&quot;&amp;&quot;,&nbsp;$imgUrl);\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//http开头验证\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(strpos($imgUrl,&nbsp;&quot;http&quot;)&nbsp;!==&nbsp;0)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_HTTP_LINK&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//获取请求头并检测死链\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$heads&nbsp;=&nbsp;get_headers($imgUrl);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!(stristr($heads[0],&nbsp;&quot;200&quot;)&nbsp;&amp;&amp;&nbsp;stristr($heads[0],&nbsp;&quot;OK&quot;)))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_DEAD_LINK&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//格式验证(扩展名验证和Content-Type验证)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$fileType&nbsp;=&nbsp;strtolower(strrchr($imgUrl,&nbsp;&#39;.&#39;));\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!in_array($fileType,&nbsp;$this-&gt;config[&#39;allowFiles&#39;])&nbsp;||&nbsp;stristr($heads[&#39;Content-Type&#39;],&nbsp;&quot;image&quot;))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_HTTP_CONTENTTYPE&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//打开输出缓冲区并获取远程图片\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ob_start();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$context&nbsp;=&nbsp;stream_context_create(\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(&#39;http&#39;&nbsp;=&gt;&nbsp;array(\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;follow_location&#39;&nbsp;=&gt;&nbsp;false&nbsp;//&nbsp;don&#39;t&nbsp;follow&nbsp;redirects\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;))\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readfile($imgUrl,&nbsp;false,&nbsp;$context);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$img&nbsp;=&nbsp;ob_get_contents();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ob_end_clean();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;preg_match(&quot;/[\\/]([^\\/]*)[\\.]?[^\\.\\/]*$/&quot;,&nbsp;$imgUrl,&nbsp;$m);\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;oriName&nbsp;=&nbsp;$m&nbsp;?&nbsp;$m[1]:&quot;&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;fileSize&nbsp;=&nbsp;strlen($img);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;fileType&nbsp;=&nbsp;$this-&gt;getFileExt();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;fullName&nbsp;=&nbsp;$this-&gt;getFullName();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;filePath&nbsp;=&nbsp;$this-&gt;getFilePath();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;fileName&nbsp;=&nbsp;$this-&gt;getFileName();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$dirname&nbsp;=&nbsp;dirname($this-&gt;filePath);\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//检查文件大小是否超出限制\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!$this-&gt;checkSize())&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_SIZE_EXCEED&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//创建目录失败\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!file_exists($dirname)&nbsp;&amp;&amp;&nbsp;!mkdir($dirname,&nbsp;0777,&nbsp;true))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_CREATE_DIR&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(!Helper::is_writeable($dirname))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_DIR_NOT_WRITEABLE&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//移动文件\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!(file_put_contents($this-&gt;filePath,&nbsp;$img)&nbsp;&amp;&amp;&nbsp;file_exists($this-&gt;filePath)))&nbsp;{&nbsp;//移动失败\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_WRITE_CONTENT&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{&nbsp;//移动成功\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;stateMap[0];\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;上传错误检查\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$errCode\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;getStateInfo($errCode)\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;!$this-&gt;stateMap[$errCode]&nbsp;?&nbsp;$this-&gt;stateMap[&quot;ERROR_UNKNOWN&quot;]&nbsp;:&nbsp;$this-&gt;stateMap[$errCode];\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;获取文件扩展名\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;getFileExt()\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;strtolower(strrchr($this-&gt;oriName,&nbsp;&#39;.&#39;));\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;重命名文件\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;getFullName()\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//替换日期事件\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$t&nbsp;=&nbsp;time();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$d&nbsp;=&nbsp;explode(&#39;-&#39;,&nbsp;date(&quot;Y-y-m-d-H-i-s&quot;));\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$format&nbsp;=&nbsp;$this-&gt;config[&quot;pathFormat&quot;];\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$format&nbsp;=&nbsp;str_replace(&quot;{yyyy}&quot;,&nbsp;$d[0],&nbsp;$format);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$format&nbsp;=&nbsp;str_replace(&quot;{yy}&quot;,&nbsp;$d[1],&nbsp;$format);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$format&nbsp;=&nbsp;str_replace(&quot;{mm}&quot;,&nbsp;$d[2],&nbsp;$format);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$format&nbsp;=&nbsp;str_replace(&quot;{dd}&quot;,&nbsp;$d[3],&nbsp;$format);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$format&nbsp;=&nbsp;str_replace(&quot;{hh}&quot;,&nbsp;$d[4],&nbsp;$format);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$format&nbsp;=&nbsp;str_replace(&quot;{ii}&quot;,&nbsp;$d[5],&nbsp;$format);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$format&nbsp;=&nbsp;str_replace(&quot;{ss}&quot;,&nbsp;$d[6],&nbsp;$format);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$format&nbsp;=&nbsp;str_replace(&quot;{time}&quot;,&nbsp;$t,&nbsp;$format);\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//过滤文件名的非法自负,并替换文件名\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oriName&nbsp;=&nbsp;substr($this-&gt;oriName,&nbsp;0,&nbsp;strrpos($this-&gt;oriName,&nbsp;&#39;.&#39;));\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oriName&nbsp;=&nbsp;preg_replace(&quot;/[\\|\\?\\&quot;\\&lt;\\&gt;\\/\\*\\\\\\\\]+/&quot;,&nbsp;&#39;&#39;,&nbsp;$oriName);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$format&nbsp;=&nbsp;str_replace(&quot;{filename}&quot;,&nbsp;$oriName,&nbsp;$format);\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//替换随机字符串\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$randNum&nbsp;=&nbsp;rand(1,&nbsp;10000000000)&nbsp;.&nbsp;rand(1,&nbsp;10000000000);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(preg_match(&quot;/\\{rand\\:([\\d]*)\\}/i&quot;,&nbsp;$format,&nbsp;$matches))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$format&nbsp;=&nbsp;preg_replace(&quot;/\\{rand\\:[\\d]*\\}/i&quot;,&nbsp;substr($randNum,&nbsp;0,&nbsp;$matches[1]),&nbsp;$format);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ext&nbsp;=&nbsp;$this-&gt;getFileExt();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$format&nbsp;.&nbsp;$ext;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;获取文件名\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;getFileName&nbsp;()&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;substr($this-&gt;filePath,&nbsp;strrpos($this-&gt;filePath,&nbsp;&#39;/&#39;)&nbsp;+&nbsp;1);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;获取文件完整路径\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;getFilePath()\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$fullname&nbsp;=&nbsp;$this-&gt;fullName;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rootPath&nbsp;=&nbsp;$_SERVER[&#39;DOCUMENT_ROOT&#39;];\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(substr($fullname,&nbsp;0,&nbsp;1)&nbsp;!=&nbsp;&#39;/&#39;)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$fullname&nbsp;=&nbsp;&#39;/&#39;&nbsp;.&nbsp;$fullname;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$rootPath&nbsp;.&nbsp;$fullname;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;文件类型检测\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;bool\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;checkType()\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;in_array($this-&gt;getFileExt(),&nbsp;$this-&gt;config[&quot;allowFiles&quot;]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;文件大小检测\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;bool\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;&nbsp;checkSize()\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$this-&gt;fileSize&nbsp;&lt;=&nbsp;($this-&gt;config[&quot;maxSize&quot;]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;获取当前上传成功文件的各项信息\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;array\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;getFileInfo()\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;array(\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;state&quot;&nbsp;=&gt;&nbsp;$this-&gt;stateInfo,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;url&quot;&nbsp;=&gt;&nbsp;$this-&gt;fullName,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;title&quot;&nbsp;=&gt;&nbsp;$this-&gt;fileName,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;original&quot;&nbsp;=&gt;&nbsp;$this-&gt;oriName,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;type&quot;&nbsp;=&gt;&nbsp;$this-&gt;fileType,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;size&quot;&nbsp;=&gt;&nbsp;$this-&gt;fileSize\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n}</pre><p>&nbsp;&nbsp; <br/></p><p>&nbsp;&nbsp;&nbsp;然后在模板页调用：</p><pre class=\"brush:php;toolbar:false\">&lt;?php&nbsp;echo&nbsp;$form-&gt;textArea($model.&#39;content&#39;);&nbsp;?&gt;\r\n&lt;?php\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;widget(&#39;application.widget.ueditor.Ueditor&#39;,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(&#39;htmlOptions&#39;=&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;=&gt;&#39;Post_content&#39;,//页面中输入框（或其他初始化容器）的ID\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;name&#39;=&gt;&#39;editor&#39;,//指定ueditor实例的名称,个页面有多个ueditor实例时使用\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;config&#39;=&gt;&nbsp;array(\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;initialFrameHeight&#39;=&gt;&#39;400&#39;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;initialFrameWidth&#39;=&gt;&#39;80%&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;?&gt;</pre><hr/><p>相关文章：</p><p><a href=\"http://www.yiifcms.com/post/42/\" title=\"增加Ueditor在线管理图片删除功能\" target=\"_blank\" style=\"\">增加Ueditor在线管理图片删除功能</a></p><p><a href=\"http://www.yiifcms.com/post/39/\" title=\" yii 操作cookie的用法详解\" target=\"_blank\" style=\"\">yii 操作cookie的用法详解</a></p><p><a href=\"http://www.yiifcms.com/post/38/\" title=\"关于人人网开发平台提供的sdk的问题\" target=\"_blank\" style=\"\">关于人人网开发平台提供的sdk的问题</a></p><p><a href=\"http://www.yiifcms.com/post/37/\" title=\"yii下实现sitemap自动生成\" target=\"_blank\" style=\"font-weight:bold;\">yii下实现sitemap自动生成</a></p><p><br/></p>','原创','','','php,web,html,js,yii,cms,baidu,ueditor,kindeditor,IT',91,'N','N','','',2,0,'N',1408691092,0,'Y',0,'Y',1408516638),
	(42,1,'增加Ueditor在线管理图片删除功能','','','','',21,0,'前天我提到了 yii下安装并使用ueditor 在使用过程中 遇到了一些问题 虽然不大 但对于追求完美的人来说 还是欲除之而后快。下面我就两个问题说下解决方案：  编辑器中图片拉伸的问题  其实可以修改成等比拉伸 这样可以避免误操作引起的图片不好看的问题 如果您不介意 那么可以不 用看：修改ueditor.all.js 大约16970行 (如果您用的是ueditor.all.min.js 那么你最好先更新下ueditor.all.js然后压缩成mini版，这里就不多说了)：  ...','','','','','<p><span style=\"font-size: 16px;\">前天我提到了 </span><a style=\"font-size: 16px; text-decoration: underline;\" title=\"yii框架下使用ueditor插件详解\" target=\"_blank\" href=\"http://www.yiifcms.com/post/41/\"><span style=\"font-size: 16px;\">yii下安装并使用ueditor</span></a><span style=\"font-size: 16px;\"> 在使用过程中 遇到了一些问题 虽然不大 但对于追求完美的人来说 还是欲除之而后快。</span></p><p><span style=\"font-size: 16px;\">下面我就两个问题说下解决方案：</span></p><p><span style=\"font-size: 16px;\">1. <strong>编辑器中图片拉伸的问题</strong>&nbsp; <br/></span></p><p><span style=\"font-size: 16px;\">&nbsp;&nbsp;&nbsp;&nbsp;其实可以修改成等比拉伸 这样可以避免误操作引起的图片不好看的问题 如果您不介意 那么可以不 用看：<br/></span></p><p><span style=\"font-size: 16px;\">&nbsp;&nbsp;&nbsp;&nbsp;修改ueditor.all.js 大约16970行 (如果您用的是ueditor.all.min.js 那么你最好先更新下ueditor.all.js然后压缩成mini版，这里就不多说了)：</span></p><pre class=\"brush:js;toolbar:false;\">/*if&nbsp;(rect[dir][2]&nbsp;!=&nbsp;0)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp&nbsp;=&nbsp;dom.clientWidth&nbsp;+&nbsp;rect[dir][2]&nbsp;*&nbsp;offset.x;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dom.style.width&nbsp;=&nbsp;me._validScaledProp(&#39;width&#39;,&nbsp;tmp)&nbsp;+&nbsp;&#39;px&#39;;\r\n}\r\nif&nbsp;(rect[dir][3]&nbsp;!=&nbsp;0)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp&nbsp;=&nbsp;dom.clientHeight&nbsp;+&nbsp;rect[dir][3]&nbsp;*&nbsp;offset.y;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dom.style.height&nbsp;=&nbsp;me._validScaledProp(&#39;height&#39;,&nbsp;tmp)&nbsp;+&nbsp;&#39;px&#39;;\r\n}*/\r\n//等比缩放图片\r\nif&nbsp;(rect[dir][2]&nbsp;!=&nbsp;0)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;tmp&nbsp;=&nbsp;dom.clientWidth&nbsp;+&nbsp;rect[dir][2]&nbsp;*&nbsp;offset.x;\r\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tmpwh&nbsp;=&nbsp;parseInt(dom.style.width)/parseInt(dom.style.height);\r\n&nbsp;&nbsp;&nbsp;&nbsp;dom.style.width&nbsp;=&nbsp;me._validScaledProp(&#39;width&#39;,&nbsp;tmp)&nbsp;+&nbsp;&#39;px&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;dom.style.height&nbsp;=&nbsp;me._validScaledProp(&#39;height&#39;,&nbsp;tmp/tmpwh)&nbsp;+&nbsp;&#39;px&#39;;\r\n}\r\nif&nbsp;(rect[dir][3]&nbsp;!=&nbsp;0)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;tmp&nbsp;=&nbsp;dom.clientHeight&nbsp;+&nbsp;rect[dir][3]&nbsp;*&nbsp;offset.y;\r\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tmpwh&nbsp;=&nbsp;parseInt(dom.style.width)/parseInt(dom.style.height);\r\n&nbsp;&nbsp;&nbsp;&nbsp;dom.style.height&nbsp;=&nbsp;me._validScaledProp(&#39;height&#39;,&nbsp;tmp)&nbsp;+&nbsp;&#39;px&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;dom.style.width&nbsp;=&nbsp;me._validScaledProp(&#39;width&#39;,&nbsp;tmp*tmpwh)&nbsp;+&nbsp;&#39;px&#39;;\r\n}</pre><p><span style=\"font-size: 16px;\">2.&nbsp; <strong>就是本文要说的在线管理图片没有删除功能的问题</strong> <br/></span></p><p><span style=\"font-size: 16px;\">&nbsp;&nbsp;&nbsp;&nbsp;我的原理是 检索出图片之后 增加一个删除的按钮或者链接 然后请求服务端删除 接收返回结果 提示是否成功删除：</span></p><p><span style=\"font-size: 16px;\">&nbsp;&nbsp; 第一步： 需要增加一个后端请求删除的url&nbsp; 这样可以在config.json里面增加一项即可&nbsp; 我这里在控制器层初始化了$CONFIG：</span></p><pre class=\"brush:php;toolbar:false\">&#39;imageDelUrl&#39;&nbsp;=&gt;&nbsp;$this-&gt;createUrl(&#39;uploadify/ajaxDel&#39;),&nbsp;//在线图片管理删除操作请求url</pre><p>&nbsp;&nbsp; <span style=\"font-size: 16px;\">第二步：增加js删除方法，放到ueditor/dialogs/image/image.html里面 ：</span></p><pre class=\"brush:js;toolbar:false\">&lt;script&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;//新增在线管理删除图片\r\n&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;uedel(path,&nbsp;id){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(confirm(&#39;您确定要删除它吗？删除后不可恢复！&#39;)){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;url&nbsp;=&nbsp;editor.getOpt(&#39;imageDelUrl&#39;);&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.get(url,{&#39;path&#39;:path},function(data){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(data.state&nbsp;==&nbsp;&#39;success&#39;)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert(data.message);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&quot;#&quot;+id).parent(&quot;li&quot;).remove();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert(data.message);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&#39;json&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;/script&gt;</pre><p>&nbsp;&nbsp; <span style=\"font-size: 16px;\">大家可以看到 我用了一句</span></p><pre class=\"brush:js;toolbar:false\">editor.getOpt(&#39;imageDelUrl&#39;);</pre><p>&nbsp;&nbsp; <span style=\"font-size: 16px;\">这是自带的方法 可以自定义url&nbsp; 由于已经加载了jquery 所以我也就直接ajax请求了</span></p><p><span style=\"font-size: 16px;\">&nbsp;&nbsp; 第三步： 修改ueditor/dialogs/image/image.js文件（大约902行）</span></p><pre class=\"brush:js;toolbar:false;\">&nbsp;&nbsp;&nbsp;&nbsp;del&nbsp;=&nbsp;document.createElement(&#39;a&#39;);&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;del.innerHTML&nbsp;=&nbsp;&#39;删除&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;domUtils.addClass(del,&nbsp;&#39;del&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;delid=&#39;imagelist_&#39;+i;\r\n&nbsp;&nbsp;&nbsp;&nbsp;del.setAttribute(&#39;id&#39;,delid);\r\n&nbsp;&nbsp;&nbsp;&nbsp;del.setAttribute(&#39;href&#39;,&#39;javascript:;&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;del.setAttribute(&#39;onclick&#39;,&#39;uedel(&quot;&#39;+list[i].url+&#39;&quot;,&quot;&#39;+delid+&#39;&quot;)&#39;);</pre><p>&nbsp;&nbsp;&nbsp; <span style=\"font-size: 16px;\">924行 增加一句：item.appendChild(del); 为了把a标签加载进去</span></p><p><span style=\"font-size: 16px;\">&nbsp;&nbsp;&nbsp; 到这里 我们可以看到 已经有了“删除”链接了&nbsp; 具体样式修改 ueditor/dialogs/image/image.css 我是直接在末尾添加：</span></p><pre class=\"brush:css;toolbar:false\">/*&nbsp;新增在线管理删除图片样式*/\r\n#online&nbsp;li&nbsp;a.del&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;width:&nbsp;auto;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;position:&nbsp;absolute;\r\n&nbsp;&nbsp;&nbsp;&nbsp;top:&nbsp;0;\r\n&nbsp;&nbsp;&nbsp;&nbsp;right:&nbsp;0;\r\n&nbsp;&nbsp;&nbsp;&nbsp;color:#F00;\r\n&nbsp;&nbsp;&nbsp;&nbsp;background-color:#DDDDDD;\r\n&nbsp;&nbsp;&nbsp;&nbsp;opacity:0.8;\r\n&nbsp;&nbsp;&nbsp;&nbsp;filter:alpha(80);\r\n&nbsp;&nbsp;&nbsp;&nbsp;border:&nbsp;0;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;z-index:3;\r\n&nbsp;&nbsp;&nbsp;&nbsp;text-align:right;\r\n&nbsp;&nbsp;&nbsp;&nbsp;text-decoration:none;&nbsp;&nbsp;&nbsp;&nbsp;\r\n}</pre><p>&nbsp;&nbsp; <span style=\"font-size: 16px;\">第四步：实现删除图片的服务端方法(放到您的控制器里面即可,我的是UploadifyController 和第一步的$this-&gt;createUrl(&#39;uploadify/ajaxDel&#39;);相对应 )：</span></p><pre class=\"brush:php;toolbar:false\">&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;直接删除路径文件\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;actionAjaxDel(){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$file&nbsp;=&nbsp;$this-&gt;_request-&gt;getParam(&#39;path&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$firstchar&nbsp;=&nbsp;substr($file,0,1);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(in_array($firstchar,&nbsp;array(&#39;/&#39;,&#39;\\\\&#39;))){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$file&nbsp;=&nbsp;substr($file,1);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($file&nbsp;&amp;&amp;&nbsp;file_exists($file)){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unlink($file);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$var[&#39;state&#39;]&nbsp;=&nbsp;&#39;success&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$var[&#39;message&#39;]&nbsp;=&nbsp;&#39;删除完成&#39;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$var[&#39;state&#39;]&nbsp;=&nbsp;&#39;error&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$var[&#39;message&#39;]&nbsp;=&nbsp;&#39;删除失败，未找到&#39;.$file;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(Exception&nbsp;$e){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$var[&#39;state&#39;]&nbsp;=&nbsp;&#39;error&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$var[&#39;message&#39;]&nbsp;=&nbsp;&#39;删除失败：&#39;.$e-&gt;getMessage();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(CJSON::encode($var));\r\n&nbsp;&nbsp;&nbsp;&nbsp;}</pre><p><br/></p><p><span style=\"font-size: 16px;\">已测试通过， 如果还有不明白的地方，欢迎探讨。</span><br/></p>','原创','http://www.yiifcms.com/post/42/','','html,js,jquery,yii,cms,ueditor,IT',49,'N','N','','',0,0,'N',1408689354,0,'Y',0,'Y',1408613519),
	(43,1,'Linux crontab 命令格式与详细例子 ','','','','',3,0,'基本格式 :*　　*　　*　　*　　*　　command分　时　日　月　周　命令第1列表示分钟1～59 每分钟用*或者 */1表示第2列表示小时1～23（0表示0点）第3列表示日期1～31第4列表示月份1～12第5列标识号星期0～6（0表示星期天）第6列要运行的命令crontab文件的一些例子：30 21 * * * /usr/local/etc/rc.d/lighttpd restart上面的例子表示每晚的21:30重启apache。45 4 1,10,22 * * /usr/local/etc/rc.d/lighttpd restart上面...','','','','','<p><span style=\"font-size: 16px;\">基本格式 :<br/>*　　*　　*　　*　　*　　command<br/>分　时　日　月　周　命令</span></p><p><span style=\"font-size: 16px;\">第1列表示分钟1～59 每分钟用*或者 */1表示<br/>第2列表示小时1～23（0表示0点）<br/>第3列表示日期1～31<br/>第4列表示月份1～12<br/>第5列标识号星期0～6（0表示星期天）<br/>第6列要运行的命令</span></p><p><span style=\"font-size: 16px;\">crontab文件的一些例子：</span></p><pre class=\"brush:bash;toolbar:false\">30&nbsp;21&nbsp;*&nbsp;*&nbsp;*&nbsp;/usr/local/etc/rc.d/lighttpd&nbsp;restart</pre><p><span style=\"font-size: 16px;\">上面的例子表示每晚的21:30重启apache。</span><br/></p><pre class=\"brush:bash;toolbar:false\">45&nbsp;4&nbsp;1,10,22&nbsp;*&nbsp;*&nbsp;/usr/local/etc/rc.d/lighttpd&nbsp;restart</pre><p><span style=\"font-size: 16px;\">上面的例子表示每月1、10、22日的4 : 45重启apache。</span><br/></p><pre class=\"brush:bash;toolbar:false\">10&nbsp;1&nbsp;*&nbsp;*&nbsp;6,0&nbsp;/usr/local/etc/rc.d/lighttpd&nbsp;restart</pre><p><span style=\"font-size: 16px;\">上面的例子表示每周六、周日的1 : 10重启apache。</span><br/></p><pre class=\"brush:bash;toolbar:false\">0,30&nbsp;18-23&nbsp;*&nbsp;*&nbsp;*&nbsp;/usr/local/etc/rc.d/lighttpd&nbsp;restart</pre><p><span style=\"font-size: 16px;\">上面的例子表示在每天18 : 00至23 : 00之间每隔30分钟重启apache。</span><br/></p><pre class=\"brush:bash;toolbar:false\">0&nbsp;23&nbsp;*&nbsp;*&nbsp;6&nbsp;/usr/local/etc/rc.d/lighttpd&nbsp;restart</pre><p><span style=\"font-size: 16px;\">上面的例子表示每星期六的11 : 00 pm重启apache。</span><br/></p><pre class=\"brush:bash;toolbar:false\">*&nbsp;*/1&nbsp;*&nbsp;*&nbsp;*&nbsp;/usr/local/etc/rc.d/lighttpd&nbsp;restart</pre><p><span style=\"font-size: 16px;\">每一小时重启apache</span><br/></p><pre class=\"brush:bash;toolbar:false\">*&nbsp;23-7/1&nbsp;*&nbsp;*&nbsp;*&nbsp;/usr/local/etc/rc.d/lighttpd&nbsp;restart</pre><p><span style=\"font-size: 16px;\">晚上11点到早上7点之间，每隔一小时重启apache</span><br/></p><pre class=\"brush:bash;toolbar:false\">0&nbsp;11&nbsp;4&nbsp;*&nbsp;mon-wed&nbsp;/usr/local/etc/rc.d/lighttpd&nbsp;restart</pre><p><span style=\"font-size: 16px;\">每月的4号与每周一到周三的11点重启apache</span><br/></p><pre class=\"brush:bash;toolbar:false\">0&nbsp;4&nbsp;1&nbsp;jan&nbsp;*&nbsp;/usr/local/etc/rc.d/lighttpd&nbsp;restart</pre><p><span style=\"font-size: 16px;\">一月一号的4点重启apache</span><br/></p><p><span style=\"font-size: 16px;\">&nbsp;</span></p><p><strong><span style=\"font-size: 16px;\">名称 : crontab </span></strong></p><p><span style=\"font-size: 16px;\">使用权限 : 所有使用者 </span></p><p><span style=\"font-size: 16px;\">使用方式 : </span></p><p><span style=\"font-size: 16px;\">crontab file [-u user]-用指定的文件替代目前的crontab。 </span></p><p><span style=\"font-size: 16px;\">crontab-[-u user]-用标准输入替代目前的crontab. </span></p><p><span style=\"font-size: 16px;\">crontab-1[user]-列出用户目前的crontab. </span></p><p><span style=\"font-size: 16px;\">crontab-e[user]-编辑用户目前的crontab. </span></p><p><span style=\"font-size: 16px;\">crontab-d[user]-删除用户目前的crontab. </span></p><p><span style=\"font-size: 16px;\">crontab-c dir- 指定crontab的目录。 </span></p><p><span style=\"font-size: 16px;\">crontab文件的格式：M H D m d cmd. </span></p><p><span style=\"font-size: 16px;\">&nbsp;</span></p><p><span style=\"font-size: 16px;\">M: 分钟（0-59）。 </span></p><p><span style=\"font-size: 16px;\">H：小时（0-23）。 </span></p><p><span style=\"font-size: 16px;\">D：天（1-31）。 </span></p><p><span style=\"font-size: 16px;\">m: 月（1-12）。 </span></p><p><span style=\"font-size: 16px;\">d: 一星期内的天（0~6，0为星期天）。 </span></p><p><span style=\"font-size: 16px;\">cmd要运行的程序，程序被送入sh执行，这个shell只有USER,HOME,SHELL这三个环境变量</span></p><p><span style=\"font-size: 16px;\">说明 : </span></p><p><span style=\"font-size: 16px;\">crontab 是用来让使用者在固定时间或固定间隔执行程序之用，换句话说，也就是类似使用者的时程表。-u user 是指设定指定 </span></p><p><span style=\"font-size: 16px;\">user 的时程表，这个前提是你必须要有其权限(比如说是 root)才能够指定他人的时程表。如果不使用 -u user 的话，就是表示设</span></p><p><span style=\"font-size: 16px;\">定自己的时程表。 </span></p><p><span style=\"font-size: 16px;\">&nbsp;</span></p><p><span style=\"font-size: 16px;\">&nbsp;</span></p><p><span style=\"font-size: 16px;\">参数 : </span></p><p><span style=\"font-size: 16px;\">crontab -e : 执行文字编辑器来设定时程表，内定的文字编辑器是 VI，如果你想用别的文字编辑器，则请先设定 VISUAL 环境变数</span></p><p><span style=\"font-size: 16px;\">来指定使用那个文字编辑器(比如说 setenv VISUAL joe) </span></p><p><span style=\"font-size: 16px;\">crontab -r : 删除目前的时程表 </span></p><p><span style=\"font-size: 16px;\">crontab -l : 列出目前的时程表 </span></p><p><span style=\"font-size: 16px;\">crontab file [-u user]-用指定的文件替代目前的crontab。</span></p><p><span style=\"font-size: 16px;\">时程表的格式如下 : </span></p><p><span style=\"font-size: 16px;\">f1 f2 f3 f4 f5 program </span></p><p><span style=\"font-size: 16px;\">其中 f1 是表示分钟，f2 表示小时，f3 表示一个月份中的第几日，f4 表示月份，f5 表示一个星期中的第几天。program 表示要执</span></p><p><span style=\"font-size: 16px;\">行的程序。 </span></p><p><span style=\"font-size: 16px;\">当 f1 为 * 时表示每分钟都要执行 program，f2 为 * 时表示每小时都要执行程序，其馀类推 </span></p><p><span style=\"font-size: 16px;\">当 f1 为 a-b 时表示从第 a 分钟到第 b 分钟这段时间内要执行，f2 为 a-b 时表示从第 a 到第 b 小时都要执行，其馀类推 </span></p><p><span style=\"font-size: 16px;\">当 f1 为 */n 时表示每 n 分钟个时间间隔执行一次，f2 为 */n 表示每 n 小时个时间间隔执行一次，其馀类推 </span></p><p><span style=\"font-size: 16px;\">当 f1 为 a, b, c,... 时表示第 a, b, c,... 分钟要执行，f2 为 a, b, c,... 时表示第 a, b, c...个小时要执行，其馀类推 </span></p><p><span style=\"font-size: 16px;\">使用者也可以将所有的设定先存放在档案 file 中，用 crontab file 的方式来设定时程表。 </span></p><p><span style=\"font-size: 16px;\">例子 : </span></p><p><span style=\"font-size: 16px;\"></span></p><pre class=\"brush:bash;toolbar:false\">#每天早上7点执行一次&nbsp;/bin/ls&nbsp;:&nbsp;\r\n0&nbsp;7&nbsp;*&nbsp;*&nbsp;*&nbsp;/bin/ls</pre><p><span style=\"font-size: 16px;\"></span></p><pre class=\"brush:bash;toolbar:false\">#在&nbsp;12&nbsp;月内,&nbsp;每天的早上&nbsp;6&nbsp;点到&nbsp;12&nbsp;点中，每隔3个小时执行一次&nbsp;/usr/bin/backup&nbsp;:&nbsp;\r\n0&nbsp;6-12/3&nbsp;*&nbsp;12&nbsp;*&nbsp;/usr/bin/backup</pre><p><span style=\"font-size: 16px;\"></span></p><pre class=\"brush:bash;toolbar:false\">#周一到周五每天下午&nbsp;5:00&nbsp;寄一封信给&nbsp;alex@domain.name&nbsp;:&nbsp;\r\n0&nbsp;17&nbsp;*&nbsp;*&nbsp;1-5&nbsp;mail&nbsp;-s&nbsp;&quot;hi&quot;&nbsp;alex@domain.name&nbsp;&lt;&nbsp;/tmp/maildata</pre><p><span style=\"font-size: 16px;\"></span></p><pre class=\"brush:bash;toolbar:false\">#每月每天的午夜&nbsp;0&nbsp;点&nbsp;20&nbsp;分,&nbsp;2&nbsp;点&nbsp;20&nbsp;分,&nbsp;4&nbsp;点&nbsp;20&nbsp;分....执行&nbsp;echo&nbsp;&quot;haha&quot;&nbsp;\r\n20&nbsp;0-23/2&nbsp;*&nbsp;*&nbsp;*&nbsp;echo&nbsp;&quot;haha&quot;</pre><p><span style=\"font-size: 16px;\">注意 : </span></p><p><span style=\"font-size: 16px;\">当程序在你所指定的时间执行后，系统会寄一封信给你，显示该程序执行的内容，若是你不希望收到这样的信，请在每一行空一格之</span></p><p><span style=\"font-size: 16px;\">后加上<strong> &gt; /dev/null 2&gt;&amp;1 </strong>即可</span></p><p><span style=\"font-size: 16px;\">&nbsp;</span></p><p><span style=\"font-size: 16px;\">例子2 :</span></p><p><span style=\"font-size: 16px;\">#每天早上6点10分 </span></p><p><span style=\"font-size: 16px;\">10 6 * * * date </span></p><p><span style=\"font-size: 16px;\">#每两个小时 </span></p><p><span style=\"font-size: 16px;\">0 */2 * * * date </span></p><p><span style=\"font-size: 16px;\">#晚上11点到早上8点之间每两个小时，早上8点 </span></p><p><span style=\"font-size: 16px;\">0 23-7/2，8 * * * date </span></p><p><span style=\"font-size: 16px;\">#每个月的4号和每个礼拜的礼拜一到礼拜三的早上11点 </span></p><p><span style=\"font-size: 16px;\">0 11 4 * mon-wed date </span></p><p><span style=\"font-size: 16px;\">#1月份日早上4点 </span></p><p><span style=\"font-size: 16px;\">0 4 1 jan * date </span></p><p><span style=\"font-size: 16px;\">范例 </span></p><p><span style=\"font-size: 16px;\">$crontab -l 列出用户目前的crontab.</span></p><p><br/></p>','csdb','http://blog.csdn.net/ethanzhao/article/details/4406017','','apache,linux',30,'N','N','','',2,0,'N',1408690763,0,'Y',0,'Y',1408689318),
	(44,1,'Linux下查看文件和文件夹大小','','','','',3,0,'当磁盘大小超过标准时会有报警提示，这时如果掌握df和du命令是非常明智的选择。    df可以查看一级文件夹大小、使用比例、档案系统及其挂入点，但对文件却无能为力。    du可以查看文件及文件夹的大小。    两者配合使用，非常有效。比如用df查看哪个一级目录过大，然后用df查看文件夹或文件的大小，如此便可迅速确定症结。    下面分别简要介绍    df命令可以显示目前所有文件系统的可用空间及使用情形，请看下列...','','','','','<p>当磁盘大小超过标准时会有报警提示，这时如果掌握df和du命令是非常明智的选择。</p><p>&nbsp;&nbsp;&nbsp; df可以查看一级文件夹大小、使用比例、档案系统及其挂入点，但对文件却无能为力。<br/>&nbsp;&nbsp;&nbsp; du可以查看文件及文件夹的大小。</p><p>&nbsp;&nbsp;&nbsp; 两者配合使用，非常有效。比如用df查看哪个一级目录过大，然后用df查看文件夹或文件的大小，如此便可迅速确定症结。</p><p>&nbsp;&nbsp;&nbsp; 下面分别简要介绍</p><p>&nbsp;&nbsp;&nbsp; <strong>df命令可以显示目前所有文件系统的可用空间及使用情形</strong>，请看下列这个例子：</p><pre class=\"brush:bash;toolbar:false\">以下是代码片段：\r\n[yayug@yayu&nbsp;~]$&nbsp;df&nbsp;-h\r\nFilesystem&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Size&nbsp;&nbsp;Used&nbsp;Avail&nbsp;Use%&nbsp;Mounted&nbsp;on\r\n/dev/sda1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.9G&nbsp;&nbsp;300M&nbsp;&nbsp;3.4G&nbsp;&nbsp;&nbsp;8%&nbsp;/\r\n/dev/sda7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;100G&nbsp;&nbsp;188M&nbsp;&nbsp;&nbsp;95G&nbsp;&nbsp;&nbsp;1%&nbsp;/data0\r\n/dev/sdb1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;133G&nbsp;&nbsp;&nbsp;80G&nbsp;&nbsp;&nbsp;47G&nbsp;&nbsp;64%&nbsp;/data1\r\n/dev/sda6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.8G&nbsp;&nbsp;218M&nbsp;&nbsp;7.2G&nbsp;&nbsp;&nbsp;3%&nbsp;/var\r\n/dev/sda5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.8G&nbsp;&nbsp;166M&nbsp;&nbsp;7.2G&nbsp;&nbsp;&nbsp;3%&nbsp;/tmp\r\n/dev/sda3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.7G&nbsp;&nbsp;2.5G&nbsp;&nbsp;6.8G&nbsp;&nbsp;27%&nbsp;/usr\r\ntmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.0G&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;2.0G&nbsp;&nbsp;&nbsp;0%&nbsp;/dev/shm</pre><p>&nbsp; 参数 -h 表示使用「Human-readable」的输出，也就是在档案系统大小使用 GB、MB 等易读的格式。</p><p>&nbsp;&nbsp;&nbsp; 上面的命令输出的第一个字段（Filesystem）及最后一个字段（Mounted on）分别是档案系统及其挂入点。我们可以看到 /dev/sda1 这个分割区被挂在根目录下。</p><p>&nbsp;&nbsp;&nbsp; 接下来的四个字段 Size、Used、Avail、及 Use% 分别是该分割区的容量、已使用的大小、剩下的大小、及使用的百分比。 \r\nFreeBSD下，当硬盘容量已满时，您可能会看到已使用的百分比超过 100%，因为 FreeBSD 会留一些空间给 root，让 root \r\n在档案系统满时，还是可以写东西到该档案系统中，以进行管理。</p><p>&nbsp;&nbsp;&nbsp;<strong> du：查询文件或文件夹的磁盘使用空间 </strong></p><p>&nbsp;&nbsp;&nbsp; \r\n如果当前目录下文件和文件夹很多，使用不带参数du的命令，可以循环列出所有文件和文件夹所使用的空间。这对查看究竟是那个地方过大是不利的，所以得指定\r\n深入目录的层数，参数：--max-depth=，这是个极为有用的参数！如下，注意使用“*”，可以得到文件的使用空间大小.</p><p>&nbsp;&nbsp;&nbsp; <strong>提醒</strong>：一向命令比linux复杂的FreeBSD，它的du命令指定深入目录的层数却是比linux简化，为 -d。</p><pre class=\"brush:bash;toolbar:false\">以下是代码片段：\r\n[root@bsso&nbsp;yayu]#&nbsp;du&nbsp;-h&nbsp;--max-depth=1&nbsp;work/testing\r\n27M&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;work/testing/logs\r\n35M&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;work/testing\r\n[root@bsso&nbsp;yayu]#&nbsp;du&nbsp;-h&nbsp;--max-depth=1&nbsp;work/testing/*\r\n8.0K&nbsp;&nbsp;&nbsp;&nbsp;work/testing/func.php\r\n27M&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;work/testing/logs\r\n8.1M&nbsp;&nbsp;&nbsp;&nbsp;work/testing/nohup.out\r\n8.0K&nbsp;&nbsp;&nbsp;&nbsp;work/testing/testing_c.php\r\n12K&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;work/testing/testing_func_reg.php\r\n8.0K&nbsp;&nbsp;&nbsp;&nbsp;work/testing/testing_get.php\r\n8.0K&nbsp;&nbsp;&nbsp;&nbsp;work/testing/testing_g.php\r\n8.0K&nbsp;&nbsp;&nbsp;&nbsp;work/testing/var.php\r\n[root@bsso&nbsp;yayu]#&nbsp;du&nbsp;-h&nbsp;--max-depth=1&nbsp;work/testing/logs/\r\n27M&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;work/testing/logs/\r\n[root@bsso&nbsp;yayu]#&nbsp;du&nbsp;-h&nbsp;--max-depth=1&nbsp;work/testing/logs/*\r\n24K&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;work/testing/logs/errdate.log_show.log\r\n8.0K&nbsp;&nbsp;&nbsp;&nbsp;work/testing/logs/pertime_show.log\r\n27M&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;work/testing/logs/show.log</pre><p>值得注意的是，看见一个针对du和df命令异同的文章：《<a href=\"http://www.diybl.com/course/6_system/linux/Linuxjs/2008716/133217.html\">du df 差异导致文件系统误报解决</a>》。</p><p>&nbsp;&nbsp;&nbsp; du 统计文件大小相加 <br/>&nbsp;&nbsp;&nbsp; df&nbsp; 统计数据块使用情况</p><p>&nbsp;&nbsp;&nbsp; 如果有一个进程在打开一个大文件的时候,这个大文件直接被rm 或者mv掉，则du会更新统计数值，df不会更新统计数值,还是认为空间没有释放。直到这个打开大文件的进程被Kill掉。</p><p>&nbsp;&nbsp;&nbsp; 如此一来在定期删除 /var/spool/clientmqueue下面的文件时，如果没有杀掉其进程，那么空间一直没有释放。</p><p>&nbsp;&nbsp;&nbsp; 使用下面的命令杀掉进程之后，系统恢复。<br/>&nbsp;&nbsp;&nbsp; fuser -u /var/spool/clientmqueue</p><p><span style=\"font-size: 10pt\"><strong>查看linux文件目录的大小和文件夹包含的文件数</strong></span></p><p>&nbsp;&nbsp;&nbsp; 统计总数大小</p><p>&nbsp;&nbsp;&nbsp; du -sh xmldb/</p><p>&nbsp;&nbsp;&nbsp; du -sm * | sort -n //统计当前目录大小 并安大小 排序</p><p>&nbsp;&nbsp;&nbsp; du -sk * | sort -n</p><p>&nbsp;&nbsp;&nbsp; du -sk * | grep guojf //看一个人的大小</p><p>&nbsp;&nbsp;&nbsp; du -m | cut -d &quot;/&quot; -f 2 //看第二个/ 字符前的文字</p><p>&nbsp;&nbsp;&nbsp; 查看此文件夹有多少文件 /*/*/* 有多少文件</p><p>&nbsp;&nbsp;&nbsp; du xmldb/</p><p>&nbsp;&nbsp;&nbsp; du xmldb/*/*/* |wc -l</p><p>&nbsp;&nbsp;&nbsp; 40752</p><p>&nbsp;&nbsp;&nbsp; 解释：</p><p>&nbsp;&nbsp;&nbsp; wc [-lmw]</p><p>&nbsp;&nbsp;&nbsp; 参数说明：</p><p>&nbsp;&nbsp;&nbsp; -l :多少行</p><p>&nbsp;&nbsp;&nbsp; -m:多少字符</p><p>&nbsp;&nbsp;&nbsp; -w:多少字</p><pre class=\"brush:bash;toolbar:false\">Linux:ls以K、M、G为单位查看文件大小\r\n#man&nbsp;ls\r\n\r\n……\r\n\r\n-h,&nbsp;--human-readable\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;sizes&nbsp;in&nbsp;human&nbsp;readable&nbsp;format&nbsp;(e.g.,&nbsp;1K&nbsp;234M&nbsp;2G)\r\n\r\n……\r\n\r\n#&nbsp;ls\r\n\r\ncuss.war&nbsp;&nbsp;&nbsp;&nbsp;nohup.out\r\n\r\n#&nbsp;ls&nbsp;-l\r\n\r\ntotal&nbsp;30372\r\n\r\n-rw-r--r--&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;root&nbsp;root&nbsp;31051909&nbsp;May&nbsp;24&nbsp;10:07&nbsp;cuss.war\r\n\r\n-rw-------&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;root&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;Mar&nbsp;20&nbsp;13:52&nbsp;nohup.out\r\n\r\n#&nbsp;ls&nbsp;-lh\r\n\r\ntotal&nbsp;30M\r\n\r\n-rw-r--r--&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;root&nbsp;root&nbsp;30M&nbsp;May&nbsp;24&nbsp;10:07&nbsp;cuss.war\r\n\r\n-rw-------&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;root&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;Mar&nbsp;20&nbsp;13:52&nbsp;nohup.out\r\n\r\n#&nbsp;ll&nbsp;-h\r\n\r\ntotal&nbsp;30M\r\n\r\n-rw-r--r--&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;root&nbsp;root&nbsp;30M&nbsp;May&nbsp;24&nbsp;10:07&nbsp;cuss.war\r\n\r\n-rw-------&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;root&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;Mar&nbsp;20&nbsp;13:52&nbsp;nohup.out</pre><hr/><p>相关文章：</p><p><a href=\"http://www.yiifcms.com/post/43/\" title=\"Linux crontab 命令格式与详细例子 \" target=\"_blank\" style=\"\">Linux crontab 命令格式与详细例子</a></p><p><a href=\"http://www.yiifcms.com/post/40/\" title=\"nginx+apache反向代理配置详解\" target=\"_blank\" style=\"\">nginx+apache反向代理配置详解</a></p><p><a href=\"http://www.yiifcms.com/post/33/\" title=\"Linux之编辑器Vim篇（配置与高级技巧） \" target=\"_blank\" style=\"\">Linux之编辑器Vim篇（配置与高级技巧）</a></p><p><br/></p>','cnblogs','http://www.cnblogs.com/benio/archive/2010/10/13/1849946.html','','php,html,js,apache,nginx,yii,linux,cms,文章,IT',51,'N','N','','',2,0,'N',1408695544,0,'Y',0,'Y',1408690639),
	(45,1,'Yii CDbCriteria的常用方法','','','','',20,0,'这是Yii CDbCriteria的一些笔记和常用用法：$criteria = new CDbCriteria;       $criteria-&gt;addCondition(&quot;id=1&quot;); //查询条件，即where id = 1   $criteria-&gt;addInCondition(&#039;id&#039;, array(1,2,3,4,5)); //代表where id IN (1,23,,4,5,);   $criteria-&gt;addNotInCondition(&#039;id&#039;, array(1,2,3,4,5));//与上面正好相法，是NOT IN   $criteria-&gt;addCondition(&#039;id=1&#039;,&#039;OR&#039;);//这是OR条件，多个条件的时候，该...','','','','','<p><span style=\"font-size: 14px;\">这是Yii CDbCriteria的一些笔记和常用用法：</span></p><pre class=\"brush:php;toolbar:false\">$criteria&nbsp;=&nbsp;new&nbsp;CDbCriteria;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n$criteria-&gt;addCondition(&quot;id=1&quot;);&nbsp;//查询条件，即where&nbsp;id&nbsp;=&nbsp;1&nbsp;&nbsp;\r\n$criteria-&gt;addInCondition(&#39;id&#39;,&nbsp;array(1,2,3,4,5));&nbsp;//代表where&nbsp;id&nbsp;IN&nbsp;(1,23,,4,5,);&nbsp;&nbsp;\r\n$criteria-&gt;addNotInCondition(&#39;id&#39;,&nbsp;array(1,2,3,4,5));//与上面正好相法，是NOT&nbsp;IN&nbsp;&nbsp;\r\n$criteria-&gt;addCondition(&#39;id=1&#39;,&#39;OR&#39;);//这是OR条件，多个条件的时候，该条件是OR而非AND&nbsp;&nbsp;\r\n$criteria-&gt;addSearchCondition(&#39;name&#39;,&nbsp;&#39;分类&#39;);//搜索条件，其实代表了。。where&nbsp;name&nbsp;like&nbsp;&#39;%分类%&#39;&nbsp;&nbsp;\r\n$criteria-&gt;addBetweenCondition(&#39;id&#39;,&nbsp;1,&nbsp;4);//between&nbsp;1&nbsp;and&nbsp;4&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;\r\n$criteria-&gt;compare(&#39;id&#39;,&nbsp;1);&nbsp;&nbsp;&nbsp;&nbsp;//这个方法比较特殊，他会根据你的参数自动处理成addCondition或者addInCondition，&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//即如果第二个参数是数组就会调用addInCondition&nbsp;&nbsp;\r\n/**&nbsp;\r\n&nbsp;*&nbsp;传递变量&nbsp;\r\n&nbsp;*/&nbsp;&nbsp;\r\n$criteria-&gt;addCondition(&quot;id&nbsp;=&nbsp;:id&quot;);&nbsp;&nbsp;\r\n$criteria-&gt;params[&#39;:id&#39;]=1;&nbsp;&nbsp;\r\n/**&nbsp;\r\n&nbsp;*&nbsp;一些public&nbsp;vars&nbsp;\r\n&nbsp;*/&nbsp;&nbsp;\r\n$criteria-&gt;select&nbsp;=&nbsp;&#39;id,parentid,name&#39;;&nbsp;//代表了要查询的字段，默认select=&#39;*&#39;;&nbsp;&nbsp;\r\n$criteria-&gt;join&nbsp;=&nbsp;&#39;xxx&#39;;&nbsp;//连接表&nbsp;&nbsp;\r\n$criteria-&gt;with&nbsp;=&nbsp;&#39;xxx&#39;;&nbsp;//调用relations&nbsp;&nbsp;&nbsp;\r\n$criteria-&gt;limit&nbsp;=&nbsp;10;&nbsp;&nbsp;&nbsp;&nbsp;//取1条数据，如果小于0，则不作处理&nbsp;&nbsp;\r\n$criteria-&gt;offset&nbsp;=&nbsp;1;&nbsp;&nbsp;&nbsp;//两条合并起来，则表示&nbsp;limit&nbsp;10&nbsp;offset&nbsp;1,或者代表了。limit&nbsp;1,10&nbsp;&nbsp;\r\n$criteria-&gt;order&nbsp;=&nbsp;&#39;xxx&nbsp;DESC,XXX&nbsp;ASC&#39;&nbsp;;//排序条件&nbsp;&nbsp;\r\n$criteria-&gt;group&nbsp;=&nbsp;&#39;group&nbsp;条件&#39;;&nbsp;&nbsp;\r\n$criteria-&gt;having&nbsp;=&nbsp;&#39;having&nbsp;条件&nbsp;&#39;;&nbsp;&nbsp;\r\n$criteria-&gt;distinct&nbsp;=&nbsp;FALSE;&nbsp;//是否唯一查询</pre><hr/><p>相关文章：</p><p><a href=\"http://www.yiifcms.com/post/39/\" title=\" yii 操作cookie的用法详解\" target=\"_blank\" style=\"font-size: 16px; text-decoration: underline;\"><span style=\"font-size: 16px;\">yii 操作cookie的用法详解</span></a></p><p><a href=\"http://www.yiifcms.com/post/38/\" title=\"关于人人网开发平台提供的sdk的问题\" target=\"_blank\" style=\"font-size: 16px; text-decoration: underline;\"><span style=\"font-size: 16px;\">关于人人网开发平台提供的sdk的问题</span></a></p><p><a href=\"http://www.yiifcms.com/post/37/\" title=\"yii下实现sitemap自动生成\" target=\"_blank\" style=\"font-weight: bold; font-size: 16px; text-decoration: underline;\"><span style=\"font-size: 16px;\">yii下实现sitemap自动生成</span></a></p><p><a href=\"http://www.yiifcms.com/post/29/\" title=\"Yii 框架创建自己的 web 应用\" target=\"_blank\" style=\"font-size: 16px; text-decoration: underline;\"><span style=\"font-size: 16px;\">Yii 框架创建自己的 web 应用</span></a><br/></p>','原创','','','web,yii,cms,IT,文章,人人网',45,'N','N','','',0,0,'N',1408699249,0,'Y',0,'Y',1408698921),
	(46,1,'php遍历文件夹','','','','',17,0,'遍历文件夹、文件目录、可递归遍历    /**      * 遍历文件夹      * @param string $dir      * @param boolean $all  true表示递归遍历      * @return array      */     public static function scanfDir($dir=&#039;&#039;, $all = false, &amp;$ret = array()){             if ( false !== ($handle = opendir ( $dir ))) {             while ...','','','','','<p>遍历文件夹、文件目录、可递归遍历</p><pre class=\"brush:php;toolbar:false\">&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;遍历文件夹\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string&nbsp;$dir\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;boolean&nbsp;$all&nbsp;&nbsp;true表示递归遍历\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;array\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;scanfDir($dir=&#39;&#39;,&nbsp;$all&nbsp;=&nbsp;false,&nbsp;&amp;$ret&nbsp;=&nbsp;array()){&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;false&nbsp;!==&nbsp;($handle&nbsp;=&nbsp;opendir&nbsp;(&nbsp;$dir&nbsp;)))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(&nbsp;false&nbsp;!==&nbsp;($file&nbsp;=&nbsp;readdir&nbsp;(&nbsp;$handle&nbsp;))&nbsp;)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!in_array($file,&nbsp;array(&#39;.&#39;,&nbsp;&#39;..&#39;,&nbsp;&#39;.git&#39;,&nbsp;&#39;.gitignore&#39;,&nbsp;&#39;.svn&#39;,&nbsp;&#39;.htaccess&#39;,&nbsp;&#39;.buildpath&#39;,&#39;.project&#39;)))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cur_path&nbsp;=&nbsp;$dir&nbsp;.&nbsp;&#39;/&#39;&nbsp;.&nbsp;$file;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(is_dir&nbsp;(&nbsp;$cur_path&nbsp;))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ret[&#39;dirs&#39;][]&nbsp;=$cur_path;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$all&nbsp;&amp;&amp;&nbsp;self::scanfDir(&nbsp;$cur_path,&nbsp;$all,&nbsp;$ret);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ret&nbsp;[&#39;files&#39;]&nbsp;[]&nbsp;=&nbsp;$cur_path;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closedir&nbsp;(&nbsp;$handle&nbsp;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$ret;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}</pre><p><br/></p><p><span style=\"font-size: 16px;\"><strong>返回的$ret[&#39;dirs&#39;]是所有目录 $ret[&#39;files&#39;]是所有文件，如果想对目录或者文件排序 可以用asort();</strong></span><br/></p>','原创','http://www.yiifcms.com/post/46/','','php,IT',32,'N','N','','',0,0,'N',1409031824,0,'Y',0,'Y',1409031776),
	(47,1,'php5.5.14编译安装参数','','','','',3,0,' 昨天我在阿里云主机上安装redis.so扩展的时候 发现一直安装失败 提示 PHP startup: Unable to load dynamic library 可是redis已经编译安装了呀 为什么php启动的时候 反而不通过呢  后来发现了 我的安装了多个版本的php(php.5.4.27/php.5.5.14) 也不知当初怎么安装的 竟然成功的安装到同一个目录下 编译redis的时候 由于要先phpize查看下版本 发现问题了 php.5.4.17应该是 PHP Version 20100525 但是却显示PHP Version 20121212...','','','','','<p>\r\n	&nbsp;昨天我在阿里云主机上安装redis.so扩展的时候 发现一直安装失败 提示 PHP startup: Unable to load dynamic library 可是redis已经编译安装了呀 为什么php启动的时候 反而不通过呢&nbsp; 后来发现了 我的安装了多个版本的php(php.5.4.27/php.5.5.14) 也不知当初怎么安装的 竟然成功的安装到同一个目录下 编译redis的时候 由于要先phpize查看下版本 发现问题了 php.5.4.17应该是 PHP Version 20100525 但是却显示PHP Version 20121212 好吧 我知道 这两个php冲突了&nbsp; 无奈 重新编译个php吧 也懒得下载 直接用php5.5.14吧\r\n</p>\r\n<p>\r\n	&nbsp; 以前总是看教程，搜资料编译php，如今我也试着记忆编译参数：(支持apache,fpm)\r\n</p>\r\n<pre class=\"prettyprint linenums lang-bsh\">cd php.5.5.14\r\n./configure --prefix=/alidata/server/php-5.5.14/ --with-config-file-path=/alidata/server/php-5.5.14/etc  \r\n--with-apxs2=/alidata/server/apache/bin/apxs  --with-mysql --with-mysqli --with-pdo-mysql --with-libxml-dir \r\n--with-gd --with-freetype-dir --with-curl --with-xmlrpc --with-curl --with-iconv=/usr/local/ --with-zlib \r\n--with-jpeg-dir --with-png-dir --with-openssl --enable-fpm --enable-static --disable-inline-optimization --enable-sockets \r\n--enable-zip --enable-calendar --enable-bcmath --enable-soap --enable-ftp --with-mcrypt --enable-shared --disable-fileinfo\r\nmake ZEND_EXTRA_LIBS=\'-liconv\'\r\nmake install</pre>\r\n<br />\r\n<p>\r\n	<br />\r\n</p>','原创','http://www.yiifcms.com/post/47/','','php,mysql,sql,apache,IT',81,'N','N','','',4,0,'N',1412915906,0,'Y',0,'Y',1409197669);

/*!40000 ALTER TABLE `mf_post` ENABLE KEYS */;
UNLOCK TABLES;

/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
